{
  "policyUpi": "PC-GCP-SQL-89",
  "policyId": "08d12f5a-eaef-416b-9597-3e557ffa9161",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "SQL Instances do not have SSL configured",
  "description": "Checks to verify that the SSL configuration for the SQL instance is valid with an unexpired SSL certificate.\n        Cloud SQL supports connecting to an instance using the Secure Socket Layer (SSL) protocol. If you are not connecting to an instance by using Cloud SQL Proxy, you should use SSL, so that the data you send and receive from Google Cloud SQL is secure.",
  "rule.criteria": "34249a95-438c-4780-a27c-e3d50092c177",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name='gcloud-sql-instances-list' and json.rule = \"(settings.ipConfiguration.requireSsl is true and _DateTime.ageInDays(serverCaCert.expirationTime) > -1) or not (settings.ipConfiguration.requireSsl is true)\"",
  "recommendation": "1. Log in to GCP Console and from Storage, select SQL.\n        2. Select the identified SQL instance and select 'SSL' tab.\n        3. Review and verify that the SSL certificate is valid with a future expiry date.\n        4. To renew / update the SSL certificate, follow the steps from the following link:\n        Reference: https://cloud.google.com/sql/docs/mysql/configure-ssl-instance",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CSA CCM v3.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "FFIEC",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "SOC 2",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}