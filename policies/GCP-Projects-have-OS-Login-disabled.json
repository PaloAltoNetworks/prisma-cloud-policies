{
  "policyUpi": "PC-GCP-GCE-208",
  "policyId": "82dcb04d-0fae-4d38-9692-fc7dabc0e50c",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Projects have OS Login disabled",
  "description": "This policy identifies GCP Projects which have OS Login disabled. Enabling OS Login ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management which is useful in handling cases like a response to compromised SSH key pairs.",
  "rule.criteria": "84158703-d321-484e-be15-a780c2dfca48",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-project-info' AND json.rule = 'commonInstanceMetadata.items[*].key does not contain enable-oslogin or (commonInstanceMetadata.items[?any(key contains enable-oslogin and (value contains false or value contains FALSE))] exists)'",
  "recommendation": "1. Login to GCP Portal\n2. Navigate to service 'Computer Engine' (Left Panel)\n3. For setting project-level OS login configuration, go to the 'Metadata' section under 'Settings'(from Left Panel)\n4. Click on the 'Edit' button\n5. If the metadata for 'enable-oslogin' is not set, click on '+Add item' and add metadata entry key as 'enable-oslogin' and the value as 'TRUE'/'true'\n6. Click on 'Save' to apply the changes\n7. You need to validate if any overriding instance-level metadata is set,\n8. Go to the tab 'VM instances', under section 'Virtual machines', \n9. For every instance, click on 'Edit'\n10. Under Custom metadata, remove any entry with key 'enable-oslogin' and the value 'FALSE'/'false'\n11. At the bottom of the 'VM instance details' page, click 'Save' to apply your changes to the instance.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 1",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST v.9.4.2",
    "ISO 27001:2013",
    "ISO 27002:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}