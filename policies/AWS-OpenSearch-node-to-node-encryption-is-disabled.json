{
  "policyUpi": "PC-AWS-ES-800",
  "policyId": "f9ec9514-9a35-46d3-9eac-88c37734fc42",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS OpenSearch node-to-node encryption is disabled",
  "description": "This policy identifies AWS OpenSearch for which none-to-node encryption is disabled. Each OpenSearch domain resides within a dedicated VPC and, by default, traffic within the VPC is unencrypted. Enabling node to node encryption provides additional security layer by making use of TLS encryption for all communications between Amazon OpenSearch Service instances in a cluster.\n\nFor more information, please follow the URL given below,\nhttps://docs.aws.amazon.com/opensearch-service/latest/developerguide/ntn.html",
  "rule.criteria": "2e660a3c-0d65-4d5e-a8dd-42a8fd630a9a",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-es-describe-elasticsearch-domain' AND json.rule = processing is false and (nodeToNodeEncryptionOptions.enabled is false or nodeToNodeEncryptionOptions.enabled does not exist)",
  "recommendation": "Go to https://aws.amazon.com, and then choose Sign In to the Console\n1. Under Analytics, choose Amazon OpenSearch Service\n2. Choose your domain\n3. Choose Actions, Edit security configuration\n4. Under Encryption section, check Node-to-node encryption\n5. Click Save changes button\n\nFor more details on node-to-node encryption for an Amazon OpenSearch Service Domain, follow below mentioned URL:\nhttps://docs.aws.amazon.com/opensearch-service/latest/developerguide/ntn.html\n\nNote: Node-to-node encryption is supported only from OpenSearch 6.0 or later. To upgrade older versions of AWS OpenSearch please refer to the URL given below,\nhttps://docs.aws.amazon.com/opensearch-service/latest/developerguide/version-migration.html",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "MLPS 2.0 (Level 2)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}