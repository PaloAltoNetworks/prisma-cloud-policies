{
  "policyUpi": "PC-GCP-SQL-750",
  "policyId": "97eeb17b-4797-4876-8980-2e3f615ec5d8",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP PostgreSQL instance database flag log_statement is not set appropriately",
  "description": "This policy identifies PostgreSQL database instances in which database flag log_statement is not set appropriately. If log_statement is not set to a correct value may lead to too many statements or too few statements. Setting log_statement to align with your organization's security and logging policies facilitates later auditing and review of database activities. It is recommended to choose an appropriate value (ddl or mod) for the flag log_statement.",
  "rule.criteria": "a446929a-da2c-494c-b4b9-9e68fec1c6ce",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-sql-instances-list' AND json.rule = state equals RUNNABLE and databaseVersion contains POSTGRES and ( settings.databaseFlags[?any( name equals \"log_statement\" )] does not exist or settings.databaseFlags[?any( name equals \"log_statement\" and value equals \"all\" or value equals \"none\" )] exists)",
  "recommendation": "1. Log in to GCP console\n2. Navigate SQL Instances page\n3. Click on reported PostgreSQL instance\n4. Click EDIT\n5. If the flag has not been set on the instance, \nUnder 'Customize your instance', click on 'ADD FLAG' in 'Flags' section, choose the flag 'log_statement' from the drop-down menu and set the value as ddl or mod\nOR\nIf the flag has been set to other than ddl or mod, Under 'Customize your instance', In 'Flags' section choose the flag 'log_statement' and set the value as ddl or mod\n6. Click on 'DONE' and then 'SAVE'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 2",
    "CRI Profile v1.2.1",
    "CSA CCM v.4.0.6",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "FFIEC",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v4.0",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}