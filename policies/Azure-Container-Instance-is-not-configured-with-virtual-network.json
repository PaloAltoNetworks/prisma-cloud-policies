{
  "policyUpi": "PC-AZR-ACI-795",
  "policyId": "d480c1d2-06b3-4e53-81c9-a21ed83cb5fc",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "low",
  "name": "Azure Container Instance is not configured with virtual network",
  "description": "This policy identifies Azure Container Instances (ACI) that are not configured with a virtual network. Making container instances public makes an internet routable network. By deploying container instances into an Azure virtual network, your containers can communicate securely with other resources in the virtual network. So it is recommended to configure all your container instances within a virtual network.\n\nFor more details:\nhttps://docs.microsoft.com/en-us/azure/container-instances/container-instances-vnet",
  "rule.criteria": "9b413f80-4055-4afd-a634-5e45f31c8109",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-container-instances-container-group' AND json.rule = properties.provisioningState equals Succeeded and properties.ipAddress.type exists and properties.ipAddress.type equals Public",
  "recommendation": "Virtual network can only be configured at the time of container instance creation. Hence, it is suggested to delete an existing container instance having not configured with virtual network and create a new container instance having virtual network configured with secure values.\nNote: Backup or migrate data from the container instance before deleting it.\n\nTo create a Container Instance within a virtual network; follow below URL:\nhttps://docs.microsoft.com/en-us/azure/container-instances/container-instances-vnet\n\nTo delete a reported Container instance; follow below URL:\nhttps://docs.microsoft.com/en-us/azure/container-instances/container-instances-quickstart-portal#clean-up-resources",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "Insurance Regulatory And Development Authority Of India",
    "MITRE ATT&CK v10.0 [Deprecated]",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MLPS 2.0 (Level 2)",
    "NIST 800-53 Rev 5",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}