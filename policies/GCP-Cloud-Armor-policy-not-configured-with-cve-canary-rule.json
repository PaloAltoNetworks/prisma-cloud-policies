{
  "policyUpi": "PC-GCP-GAS-828",
  "policyId": "3045acbb-395c-45a0-980b-7e9e605ceaa5",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Cloud Armor policy not configured with cve-canary rule",
  "description": "This policy identifies GCP Cloud Armor rules where cve-canary is not enabled. Preconfigured WAF rule called \"cve-canary\" can help detect and block exploit attempts of CVE-2021-44228 and CVE-2021-45046 to address the Apache Log4j vulnerability. It is recommended to create a Cloud Armor security policy with rule blocking Apache Log4j exploit attempts.\n\nReference : https://cloud.google.com/blog/products/identity-security/cloud-armor-waf-rule-to-help-address-apache-log4j-vulnerability",
  "rule.criteria": "67f7e9ec-ff60-4a77-98f0-a102a1352fda",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-armor-security-policy' AND json.rule = type does not equal ignore case CLOUD_ARMOR_EDGE and (rules[*].match.expr.expression does not contain cve-canary or rules[?any(match.expr.expression contains cve-canary and action equals allow)] exists)",
  "recommendation": "To Update Existing rules follow the below steps,\n\n1. Login to GCP console\n2. Navigate to 'Cloud Armor' from service 'Network Security'(Left Panel)\n3. Click on the alerted policy\n4. Click on the pencil icon on the rule to edit the rule\n5. Under 'Mode', select 'Advanced mode', add expression \"evaluatePreconfiguredExpr('cve-canary')\"\n6. Under 'Action', select 'Deny' to block the exploit\n7. Click on 'Update'\n\nTo Add rule follow the below steps,\n\n1. Login to GCP console\n2. Navigate to 'Cloud Armor' from service 'Network Security'(Left Panel)\n3. Click on the alerted policy\n4. Click on 'Add rule'\n5. Under 'Mode', select 'Advanced mode', add expression \"evaluatePreconfiguredExpr('cve-canary')\"\n6. Under 'Action', select 'Deny' to block the exploit\n7. Update other details and click on 'Add'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CRI Profile v2.0",
    "CSA CCM v4.0.12",
    "DORA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Microsoft Cloud Security Benchmark v1",
    "NIST CSF v2.0",
    "NYDFS 23 CRR-NY 500.0",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2"
  ]
}