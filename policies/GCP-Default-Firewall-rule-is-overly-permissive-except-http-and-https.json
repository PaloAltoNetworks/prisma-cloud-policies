{
  "policyUpi": "PC-GCP-VPC-86",
  "policyId": "3b814978-44a0-4a5b-9736-492d67ee4994",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "high",
  "name": "GCP Default Firewall rule is overly permissive (except http and https)",
  "description": "This policy identifies the Firewall rules that are configured with default firewall rule. The default Firewall rules will apply to all instances by default in the absence of specific custom rules with higher priority. It is a safe practice to not have these rules in the default Firewall.",
  "rule.criteria": "a1d88a90-aede-4678-8e01-6cc08074bcf5",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name= 'gcloud-compute-firewall-rules-list' AND json.rule = 'disabled is false and (name equals default-allow-ssh or name equals default-allow-icmp or name equals default-allow-internal or name equals default-allow-rdp) and (deleted is false) and (sourceRanges[*] contains 0.0.0.0/0 or sourceRanges[*] contains ::/0)'",
  "recommendation": "1. Login to GCP Console\n2. Navigate to 'VPC network' Under service 'NETWORKING'\n3. Click on section 'Firewall' on left panel\n4. For 'default' rule, apply filter 'Name : default-',\n5. select all the rules which start with 'default-' (except http, https) and click on 'DELETE' icon\n6. On pop-up window, click on 'DELETE'",
  "remediable": true,
  "remediation.cliScriptTemplate": "gcloud compute --project=${account} firewall-rules update ${resourceName} --disabled",
  "remediation.description": "This CLI command requires 'compute.firewalls.update' and 'compute.networks.updatePolicy' permission. Successful execution will disable default Firewall rule which is overly permissive (except http and https).",
  "remediation.impact": "Disable GCP Default Firewall rule which is overly permissive (except http and https)",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CSA CCM v3.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "SOC 2"
  ]
}