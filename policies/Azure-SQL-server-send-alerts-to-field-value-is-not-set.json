{
  "policyUpi": "PC-AZR-SQL-436",
  "policyId": "0f0565eb-a289-453c-86b9-f64149757e4f",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "low",
  "name": "Azure SQL server send alerts to field value is not set",
  "description": "This policy identifies the SQL servers in which send alerts to field value is not set. It is recommended to set a valid email address for threat detection alerts so that the mentioned email will receive alerts when any anomalous activities are detected on SQL servers.",
  "rule.criteria": "daf7ad41-1926-4efa-b231-ae0675fe5073",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-sql-server-list' AND json.rule = 'serverSecurityAlertPolicy does not exist or serverSecurityAlertPolicy.[*] is empty or (serverSecurityAlertPolicy.properties.state equals Enabled and serverSecurityAlertPolicy.properties.emailAddresses is empty)'",
  "recommendation": "1. Log in to Azure Portal\n2. Navigate to the SQL servers dashboard\n3. Click on the reported each DB server\n4. Click on Advanced data security (under 'SETTINGS')\n5. Set ADVANCED DATA SECURITY to 'ON'\n6. Set 'Send alerts to' field with a valid email address (under 'ADVANCED THREAT PROTECTION SETTINGS')\n7. Click on Save",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CIS v1.2.0 (Azure)",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1"
  ]
}