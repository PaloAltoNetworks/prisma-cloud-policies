{
  "policyUpi": "PC-GCP-GCE-534",
  "policyId": "7e4e6196-4922-4efd-acb9-7a4afc1c379a",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP VM instance using a default service account with Cloud Platform access scope",
  "description": "GCP VM instances employing the default service account with 'cloud-platform' access scope present a significant security risk. These instances possess excessive privileges, increasing the potential for unauthorized access and data breaches.\n\nThe default service account, 'Compute Engine default service account', coupled with the 'cloud-platform' scope, grants VMs extensive access to GCP resources. This broad access enables attackers who compromise a VM to potentially escalate privileges and access sensitive data or other resources. Failure to restrict access elevates the impact of a successful compromise.\n\nA misconfiguration allowing broad access significantly increases the blast radius of a successful attack. An attacker gaining control of a compromised VM with 'cloud-platform' scope could access and manipulate any GCP resource, leading to data exfiltration, service disruption, or complete account takeover. Restricting access aligns with the principle of least privilege, minimizing the potential damage from a security incident.\n\nRemediate this risk by assigning VMs custom service accounts with only the necessary permissions. Define a clear set of required permissions for each service account and regularly review and update these permissions. Use the IAM (Identity and Access Management) functionality to manage access carefully. Employ least privilege, only granting necessary roles to specific service accounts assigned to Virtual Machines.",
  "rule.criteria": "b47d9e56-f289-46c4-a8e2-3c0b564f2c6a",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = (status equals RUNNING and name does not start with \"gke-\") and serviceAccounts[*].email contains \"-compute@developer.gserviceaccount.com\" and serviceAccounts[*].scopes[*] any equal \"https://www.googleapis.com/auth/cloud-platform\"",
  "recommendation": "1. Log in to the GCP portal\n2. Go to Compute Engine\n3. Choose VM instances\n4. Click on the reported VM instance for which you want to change the service account\n5. If the instance is not stopped, click the 'Stop' button. Wait for the instance to be stopped\n6. Next, click the 'Edit' button\n7. Scroll down to the 'Service Account' section, From the drop-down menu, select the desired service account.\n8. Ensure 'Allow full access to all Cloud APIs' is not selected or 'Cloud Platform' under 'Set access for each API' is not enabled\n9. Click the 'Save' button and then click 'START' to start the VM instance.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "Australian Cyber Security Centre (ACSC) Essential Eight",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.0.0 (GCP)",
    "CRI Profile v2.0",
    "CSA CCM v.4.0.1",
    "Cloud Security Assurance Program (CSAP) - IaaS",
    "Cloud Security Assurance Program (CSAP) - Low",
    "Cloud Security Assurance Program (CSAP) - Low SaaS",
    "Cloud Security Assurance Program (CSAP) - SaaS Simplified",
    "Cloud Security Assurance Program (CSAP) - SaaS Standard",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "Insurance Regulatory And Development Authority Of India",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "Microsoft Cloud Security Benchmark v1",
    "NCSC - Cyber Essentials",
    "NCSC Cloud Security Principles",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}