{
  "policyUpi": "PC-AWS-EKS-380",
  "policyId": "9cd45e64-7469-4ce6-b5cf-60729a7263bb",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS EKS cluster endpoint access publicly enabled",
  "description": "When you create a new cluster, Amazon EKS creates an endpoint for the managed Kubernetes API server that you use to communicate with your cluster (using Kubernetes management tools such as kubectl). By default, this API server endpoint is public to the internet, and access to the API server is secured using a combination of AWS Identity and Access Management (IAM) and native Kubernetes Role Based Access Control (RBAC).\n\nThis policy checks your Kubernetes cluster endpoint access and triggers an alert if publicly enabled.",
  "rule.criteria": "4b508cb7-9a42-4ad2-a2e3-ed3921e00015",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-eks-describe-cluster' AND json.rule =  resourcesVpcConfig.endpointPublicAccess is true or resourcesVpcConfig.endpointPrivateAccess is false",
  "recommendation": "Enable private access to the Kubernetes API server so that all communication between your worker nodes and the API server stays within your VPC. Disable public access to your API server so that it's not accessible from the internet.\n\n1. Login to AWS Console\n2. Navigate to the Amazon EKS dashboard\n3. Choose the name of the cluster to display your cluster information\n4. Under Networking, choose 'Manage networking'\n5. Select 'Private' radio button\n6. Click on 'Save changes'",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws eks update-cluster-config --name ${resourceName} --region ${region} --resources-vpc-config endpointPublicAccess=false,endpointPrivateAccess=true",
  "remediation.description": "This CLI command requires 'eks:UpdateClusterConfig' permission. Successful execution will disable public access for the respective EKS cluster and set private access.",
  "remediation.impact": "Disable automatic public IP assignment for the respective Subnet",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Fedramp (Low)",
    "Fedramp (Moderate)",
    "HITRUST CSF v.9.6.0",
    "HITRUST v.9.4.2",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Risk Management in Technology (RMiT)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}