{
  "policyUpi": "PC-AZR-APP-679",
  "policyId": "55c94d7a-9608-4fa7-bd08-d99c05c2678a",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "informational",
  "name": "Azure Function App client certificate is disabled",
  "description": "This policy identifies Azure Function App which are not set with client certificate. Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.",
  "rule.criteria": "60257de1-5ca3-468d-aac0-c522b0e862e1",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case \"Running\" AND kind contains \"functionapp\" AND kind does not contain \"workflowapp\" AND kind does not equal \"app\" AND properties.clientCertEnabled is false",
  "recommendation": "1. Log in to the Azure portal\n2. Navigate to Function App\n3. Click on the reported Function App\n4. Under Setting section, Click on 'Configuration'\n5. Under 'General Settings' tab, In 'Incoming client certificates', Set 'Client certificate mode' to Require\n6. Click on 'Save'\n\nIf Function App Hosted in Linux using Consumption (Serverless) Plan follow below steps\nAzure CLI Command - \\\"az functionapp update --set clientCertEnabled=true --name MyFunctionApp --resource-group MyResourceGroup\\\"",
  "remediable": true,
  "remediation.cliScriptTemplate": "az functionapp update --resource-group ${resourceGroup} --name ${resourceName} --set clientCertEnabled=true",
  "remediation.description": "This CLI command requires 'Microsoft.Web/sites/Write' permission. Successful execution enables Client certificates, only clients that have a valid certificate will be able to reach the app.",
  "remediation.impact": "Enables client certificate in Azure Function App",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v.4.0.6",
    "FFIEC",
    "GDPR",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "MLPS 2.0 (Level 2)",
    "NIST SP 800-171 Revision 3",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}