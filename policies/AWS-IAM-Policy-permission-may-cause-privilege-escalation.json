{
  "policyUpi": "PC-AWS-IAM-873",
  "policyId": "6abcb8b7-f34a-4d8d-8228-486f9e284cda",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS IAM Policy permission may cause privilege escalation",
  "description": "This policy identifies AWS IAM Policy which have permission that may cause privilege escalation. AWS IAM policy having weak permissions could be exploited by an attacker to elevate privileges. It is recommended to follow the principle of least privileges ensuring that AWS IAM policy does not have these sensitive permissions.",
  "rule.criteria": "3d208afd-8254-4649-861b-34e563fbcb7f",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' and api.name = 'aws-iam-get-policy-version' AND json.rule = isAttached is true and document.Statement[?any(Effect equals Allow and (Action contains iam:CreatePolicyVersion or Action contains iam:SetDefaultPolicyVersion or Action contains iam:PassRole or Action contains iam:CreateAccessKey or Action contains iam:CreateLoginProfile or Action contains iam:UpdateLoginProfile or Action contains iam:AttachUserPolicy or Action contains iam:AttachGroupPolicy or Action contains iam:AttachRolePolicy or Action contains iam:PutUserPolicy or Action contains iam:PutGroupPolicy or Action contains iam:PutRolePolicy or Action contains iam:AddUserToGroup or Action contains iam:UpdateAssumeRolePolicy or Action contains iam:*))] exists",
  "recommendation": "Refer to the following URL to remove below listed weak permissions from reported AWS IAM Policies,\nhttps://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html#remove-policies-console\n\nBelow are the permission which can lead to privilege escalation,\niam:CreatePolicyVersion\niam:SetDefaultPolicyVersion\niam:PassRole\niam:CreateAccessKey\niam:CreateLoginProfile\niam:UpdateLoginProfile\niam:AttachUserPolicy\niam:AttachGroupPolicy\niam:AttachRolePolicy\niam:PutUserPolicy\niam:PutGroupPolicy\niam:PutRolePolicy\niam:AddUserToGroup\niam:UpdateAssumeRolePolicy\niam:*",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "Australian Cyber Security Centre (ACSC) Essential Eight",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CRI Profile v1.2.1",
    "CRI Profile v2.0",
    "CSA CCM v.4.0.6",
    "CSA CCM v4.0.12",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "FFIEC",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MLPS 2.0 (Level 2)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST CSF v2.0",
    "PCI DSS v4.0",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}