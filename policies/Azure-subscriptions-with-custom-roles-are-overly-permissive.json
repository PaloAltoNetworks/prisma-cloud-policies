{
  "policyUpi": "PC-AZR-ARM-501",
  "policyId": "40c06b29-589e-4f1f-8c02-8dafdc80cce6",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "high",
  "name": "Azure subscriptions with custom roles are overly permissive",
  "description": "Overly permissive custom roles in Azure subscriptions pose a significant security risk, allowing unauthorized access and potential data breaches. These roles, if not properly configured, grant excessive privileges beyond what's necessary for legitimate operations.\n\nAzure's role-based access control (RBAC) allows creating custom roles, but misconfiguration can grant 'Owner' or other highly privileged roles to users or groups unnecessarily. Attackers exploiting this could gain complete control over resources, leading to data exfiltration, unauthorized modifications, or service disruptions.\n\nThe impact of this misconfiguration includes data loss, system compromise, and regulatory non-compliance. Following the principle of least privilege ensures that only the minimum necessary permissions are granted, minimizing the impact of potential compromises. This strengthens the overall security posture by limiting the blast radius of any successful attack.\n\nTo mitigate this, regularly review and audit all custom roles. Ensure that each role only includes the absolute minimum required 'permissions' for its intended function. Regularly review user and group assignments to identify and remove any unnecessary permissions. Implement a robust change management process for all role modifications.",
  "rule.criteria": "aa1e6ee8-89aa-46eb-83a2-c2d8bd925117",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-role-definition' AND json.rule = properties.type equals \"CustomRole\" and properties.assignableScopes[*] contains \"/\" and properties.permissions[*].actions[*] starts with \"*\"",
  "recommendation": "Check the usage of the role identified. Verify impact caused by Updating/deleting the role. Then follow below URL for updating or deleting custom role:\nhttps://learn.microsoft.com/en-us/azure/role-based-access-control/custom-roles-portal#update-a-custom-role",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "Australian Cyber Security Centre (ACSC) Essential Eight",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "Azure Security Benchmark (v2)",
    "Azure Security Benchmark (v3)",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CIS v1.5.0 (Azure) - Level 1",
    "CSA CCM v.4.0.1",
    "CSA CCM v4.0.12",
    "Cloud Security Assurance Program (CSAP) - IaaS",
    "Cloud Security Assurance Program (CSAP) - Low",
    "Cloud Security Assurance Program (CSAP) - SaaS Standard",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "Fedramp (Moderate)",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Korea â€“ Information Security Management System (ISMS)",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "Microsoft Cloud Security Benchmark v1",
    "NCSC - Cyber Essentials",
    "NCSC Cloud Security Principles",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2"
  ]
}