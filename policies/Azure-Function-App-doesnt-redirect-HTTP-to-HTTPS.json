{
  "policyUpi": "PC-AZR-APP-677",
  "policyId": "46d8388d-72e4-413c-9a44-3670df42cfea",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure Function App doesn't redirect HTTP to HTTPS",
  "description": "This policy identifies Azure Function App which doesn't redirect HTTP to HTTPS. Azure Function App can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.",
  "rule.criteria": "82d945cb-49c0-4163-89ef-7ac3c194d4cb",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case \"Running\" AND kind contains \"functionapp\" AND kind does not contain \"workflowapp\" AND kind does not equal \"app\" AND properties.httpsOnly is false",
  "recommendation": "1. Log in to the Azure portal\n2. Navigate to Function App\n3. Click on the reported Function App\n4. Under Setting section, Click on 'TLS/SSL settings'\n5. In 'Protocol Settings', Set 'HTTPS Only' to 'On'",
  "remediable": true,
  "remediation.cliScriptTemplate": "az functionapp update --resource-group ${resourceGroup} --name ${resourceName} --set httpsOnly=true",
  "remediation.description": "This CLI command requires 'Microsoft.Web/sites/Write' permission. Successful execution set on HTTPS-only feature, by which non-secure HTTP requests can be restricted and all HTTP requests will be redirected to the secure HTTPS port.",
  "remediation.impact": "Redirects all HTTP traffic to HTTPS in Azure Function App",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v.4.0.6",
    "CSA CCM v4.0.12",
    "DORA",
    "FFIEC",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "Korea â€“ Information Security Management System (ISMS)",
    "MLPS 2.0 (Level 2)",
    "NIST 800-53 Rev 5",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 3",
    "NYDFS 23 CRR-NY 500.0",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}