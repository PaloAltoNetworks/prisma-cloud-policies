{
  "policyUpi": "PC-GCP-STO-201",
  "policyId": "e1984e80-f467-413d-9001-f2ada7e3a377",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP Storage log buckets have object versioning disabled",
  "description": "This policy identifies Storage log buckets which have object versioning disabled. Enabling object versioning on storage log buckets will protect your cloud storage data from being overwritten or accidentally deleted. It is recommended to enable object versioning feature on all storage buckets where sinks are configured.",
  "rule.criteria": "5c78818c-0fbd-4def-9e67-44c08cad77a8",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-storage-buckets-list' AND json.rule = '(acl[*].email exists and acl[*].email contains logging) and (versioning.enabled is false or versioning does not exist)'",
  "recommendation": "Follow the below mentioned URL to enable object versioning on a bucket:\n\nhttps://cloud.google.com/storage/docs/using-object-versioning#set",
  "remediable": true,
  "remediation.cliScriptTemplate": "gsutil versioning set on gs://${resourceName}",
  "remediation.description": "This CLI command requires 'storage.buckets.update' permission. Successful execution will enable GCP Storage log buckets 'versioning'.",
  "remediation.impact": "Enables versioning in GCP Storage log buckets",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.0.0 (GCP)",
    "CSA CCM v.4.0.1",
    "CSA CCM v4.0.12",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "DORA",
    "GDPR",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27001:2013",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "MITRE ATT&CK v6.3 [Deprecated]",
    "MITRE ATT&CK v8.2 [Deprecated]",
    "Microsoft Cloud Security Benchmark v1",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2"
  ]
}