{
  "policyUpi": "PC-AWS-DOC-882",
  "policyId": "8a1eca79-23af-45b2-bda4-ba6b2f4fa14a",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS DocumentDB Cluster is not enabled with data encryption in transit",
  "description": "This policy identifies Amazon DocumentDB Clusters for which data encryption in transit is disabled. Each DocumentDB Cluster is associated with a Cluster Parameter Group. It is highly recommended to implement in-transit encryption in order to protect data from unauthorized access as it travels through the network, between clients and the cluster.",
  "rule.criteria": "5884383b-5436-48fb-b76f-aa28e7edb4b8",
  "searchModel.query": "config from cloud.resource where api.name = 'aws-docdb-db-cluster-parameter-group' AND json.rule = parameters.tls.ParameterValue equals \"disabled\" as X; config from cloud.resource where api.name = 'aws-docdb-db-cluster' AND json.rule = Status equals available as Y; filter '$.X.DBClusterParameterGroupName equals $.Y.DBClusterParameterGroup'; show Y;",
  "recommendation": "To modify the Parameter group\n1. Sign in to the AWS console\n2. Select the region, from the region drop-down, for which the alert is generated\n3. Navigate to Amazon DocumentDB Dashboard\n4. Click on the 'Parameter groups' (Left panel)\n5. Select the db cluster parameter group which is associated with the DocumentDB cluster on which the alert is generated\n6. Select the \\\"tls\\\" parameter\n7. Click on \\\"Edit\\\" button\n8. Set value to \\\"enabled\\\"\n9. Click on \\\"Modify cluster parameter\\\" button\n\nTo restart the Document DB cluster\n1. Sign in to the AWS console\n2. Select the region, from the region drop-down, for which the alert is generated\n3. Navigate to Amazon DocumentDB Dashboard\n4. Click on the 'Clusters' (Left panel)\n5. Select the db cluster parameter group which is associated with the DocumentDB cluster on which the alert is generated, and choose the button to the left of its name.\n6. Choose \\\"Actions\\\", and then \\\"Reboot\\\".\n7. Click on \\\"Reboot\\\" button.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CRI Profile v2.0",
    "CSA CCM v4.0.12",
    "DORA",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "MLPS 2.0 (Level 2)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 3",
    "NYDFS 23 CRR-NY 500.0",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "Telecommunications Security Act - TSA"
  ]
}