{
  "policyUpi": "PC-AZR-KV-416",
  "policyId": "6c9c2a98-811f-4a04-8202-51285308bad9",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "informational",
  "name": "Azure Key Vault is not recoverable",
  "description": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the key vault objects.\nIt is recommended the key vault be made recoverable by enabling the \"Do Not Purge\" and \"Soft Delete\" functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.",
  "rule.criteria": "045f2c23-66af-40ef-a0cf-e04f5cda9843",
  "searchModel.query": "config from cloud.resource where api.name = 'azure-key-vault-list' AND json.rule = 'properties.enableSoftDelete does not exist or properties.enablePurgeProtection does not exist'",
  "recommendation": "Azure Portal\nAzure Portal does not have provision to update the respective configurations\n\nAzure CLI 2.0\naz resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault/vaults/<keyVaultName> --set properties.enablePurgeProtection=true properties.enableSoftDelete=true",
  "remediable": true,
  "remediation.cliScriptTemplate": "az keyvault update --name ${resourceName} --set properties.enablePurgeProtection=true properties.enableSoftDelete=true",
  "remediation.description": "This CLI command requires 'Microsoft.KeyVault/*' permission. Successful execution will enable Purge Protection and Soft Delete rule for Key Vault.\nNote: Once purge-protection and soft-delete is enabled for a key vault, the action is irreversible.",
  "remediation.impact": "enables enablePurgeProtection and enableSoftDelete in Azure Key Vault",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Azure Security Benchmark (v2)",
    "Azure Security Benchmark (v3)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.1 (Azure)",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CIS v1.5.0 (Azure) - Level 1",
    "CIS v2.0.0 (Azure) Level 1",
    "CIS v2.1.0 (Azure) Level 1",
    "CRI Profile v2.0",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "DORA",
    "FFIEC",
    "Fedramp (Low)",
    "Fedramp (Moderate)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "MITRE ATT&CK v10.0 [Deprecated]",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MLPS 2.0 (Level 2)",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Telecommunications Security Act - TSA"
  ]
}