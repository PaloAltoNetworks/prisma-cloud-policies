{
  "policyUpi": "PC-AZR-STO-297",
  "policyId": "f4784022-48f3-4f3b-bc16-2b7fef56aea3",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure storage account logging for tables is disabled",
  "description": "Storage Logging records details of requests (read, write, and delete operations) against your Azure tables. The logs include additional information such as:\n- Timing and server latency.\n- Success or failure, and HTTP status code.\n- Authentication details\n\nThis policy identifies Azure storage accounts that do not have logging enabled for tables. As a best practice, enable logging for read, write, and delete request types on tables.",
  "rule.criteria": "c6bf5b69-25d1-4b8e-ac32-e926512cf21b",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = 'sku.tier equals Standard and loggingProperties.table exists and (loggingProperties.table.readEnabled is false or loggingProperties.table.writeEnabled is false or loggingProperties.table.deleteEnabled is false)'",
  "recommendation": "1. Log in to the Azure portal.\n2. Select 'Storage Accounts'.\n3. Select the storage account you need to modify.\n4. Select 'Diagnostic Logs (classic)'.\n5. Set the 'status' to 'On'.\n6. Select 'Table properties' tab.\n7. Enable 'Logging' for the three operations - 'Read', 'Write', 'Delete'.\n8. (Optionally) Select 'Delete data', and specify the number of days for which to retain data.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Azure Security Benchmark (v2)",
    "Azure Security Benchmark (v3)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CSA CCM v.4.0.1",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST v.9.4.2",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA"
  ]
}