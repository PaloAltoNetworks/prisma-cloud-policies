{
  "policyUpi": "PC-GCP-GCE-894",
  "policyId": "a95645ec-4206-450a-9d72-b7f1cbdd5bcd",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "low",
  "name": "GCP Load Balancer SSL proxy permits SSL policies with weak cipher suites",
  "description": "This policy identifies GCP SSL Load Balancers that permit SSL policies with weak cipher suites. GCP default SSL policy uses a minimum TLS version of 1.0 and a Compatible profile, which allows the widest range of insecure cipher suites.\n\nTo prevent usage of insecure features, SSL policies should use at least TLS 1.2 with the MODERN profile; or the RESTRICTED profile, because it effectively requires clients to use TLS 1.2 regardless of the chosen minimum TLS version; or a CUSTOM profile that does not support any of the following features:\n\nTLS_RSA_WITH_AES_128_GCM_SHA256\nTLS_RSA_WITH_AES_256_GCM_SHA384\nTLS_RSA_WITH_AES_128_CBC_SHA\nTLS_RSA_WITH_AES_256_CBC_SHA\nTLS_RSA_WITH_3DES_EDE_CBC_SHA",
  "rule.criteria": "ac4a09ec-ee87-491f-a5d6-96dc03719a2b",
  "searchModel.query": "config from cloud.resource where api.name = 'gcloud-compute-target-ssl-proxy' as X; config from cloud.resource where api.name = 'gcloud-compute-ssl-policies' as Y; filter \"$.X.sslPolicy does not exist or ($.Y.profile equals COMPATIBLE and $.Y.selfLink contains $.X.sslPolicy) or ( ($.Y.profile equals MODERN or $.Y.profile equals CUSTOM) and $.Y.minTlsVersion does not equal TLS_1_2 and $.Y.selfLink contains $.X.sslPolicy ) or ( $.Y.profile equals CUSTOM and ( $.Y.enabledFeatures[*] contains TLS_RSA_WITH_AES_128_GCM_SHA256 or $.Y.enabledFeatures[*] contains TLS_RSA_WITH_AES_256_GCM_SHA384 or $.Y.enabledFeatures[*] contains TLS_RSA_WITH_AES_128_CBC_SHA or $.Y.enabledFeatures[*] contains TLS_RSA_WITH_AES_256_CBC_SHA or $.Y.enabledFeatures[*] contains TLS_RSA_WITH_3DES_EDE_CBC_SHA ) and $.Y.selfLink contains $.X.sslPolicy ) \"; show X;",
  "recommendation": "If the target SSL Proxy Load Balancer does not have any SSL policy configured, updating the proxy with either a new or an existing secured SSL policy is recommended.\n\nThe 'GCP default' SSL policy uses a minimum TLS version of 1.0 and a Compatible profile, which allows the broadest range of insecure cipher suites and is not modifiable. If this SSL policy is attached to the target SSL Proxy Load Balancer, updating the proxy with a more secured SSL policy is recommended.\n\nTo create a new SSL policy, refer to the following URL:\nhttps://cloud.google.com/load-balancing/docs/use-ssl-policies#creating_ssl_policies\n\nTo modify the existing insecure SSL policy attached to the Target SSL Proxy:\n1. Login to GCP Portal\n2. Go to Network services (Left Panel)\n3. Select Load balancing\n4. Click on 'load balancing components view' hyperlink at bottom of page to view target proxies\n5. Go to 'TARGET PROXIES' tab and Click on the reported SSL target proxy\n6. Note the 'Backend service' name.\n7. Click on the hyperlink under 'In use by'\n8. Note the 'External IP address'\n9. Select Load Balancing (Left Panel) and click on the SSL load balancer with same name as previously noted 'Backend service' name.\n10. In frontend section, consider the rule where 'IP:Port' matches the previously noted 'External IP address'.\n11. Click on the 'SSL Policy' of the rule. This will take you to the alert causing SSL policy.\n12. Click on 'EDIT'\n13. Set 'Minimum TLS Version' to TLS 1.2 and set 'Profile' to Modern or Restricted.\n14. Alternatively, if you use the profile 'Custom', make sure that the following features are disabled:\nTLS_RSA_WITH_AES_128_GCM_SHA256\nTLS_RSA_WITH_AES_256_GCM_SHA384\nTLS_RSA_WITH_AES_128_CBC_SHA\nTLS_RSA_WITH_AES_256_CBC_SHA\nTLS_RSA_WITH_3DES_EDE_CBC_SHA\n15. Click on 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CIS v2.0.0 (GCP) Level 1",
    "CIS v3.0.0 (GCP) Level 1",
    "ISO/IEC 27001:2022",
    "Risk Management in Technology (RMiT)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}