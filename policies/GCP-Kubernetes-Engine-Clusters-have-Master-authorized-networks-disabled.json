{
  "policyUpi": "PC-GCP-GKE-145",
  "policyId": "e1b70bb4-bb77-4326-93d5-5dd9c5170d3f",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "low",
  "name": "GCP Kubernetes Engine Clusters have Master authorized networks disabled",
  "description": "This policy identifies Kubernetes Engine Clusters which have disabled Master authorized networks. Enabling Master authorized networks will let the Kubernetes Engine block untrusted non-GCP source IPs from accessing the Kubernetes master through HTTPS.",
  "rule.criteria": "1bf2e381-28ab-4354-9f00-920d200be18f",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule = status equals RUNNING and (masterAuthorizedNetworksConfig.[*] is empty or masterAuthorizedNetworksConfig.enabled equals \"false\")",
  "recommendation": "Follow the below link for enabling Master authorized networks feature on kubernetes clusters,\nLink: https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks#add",
  "remediable": true,
  "remediation.cliScriptTemplate": "gcloud container clusters update ${resourceName} --project=${account} --zone ${region} --enable-master-authorized-networks",
  "remediation.description": "This CLI command requires 'container.clusters.update' permission. Successful execution will enable Master authorized network for GCP Kubernetes Engine cluster by blocking untrusted non-GCP source IPs from accessing the Kubernetes master through HTTPS.",
  "remediation.impact": "enable Master authorized network for GCP Kubernetes Engine cluster",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GKE)",
    "CIS v1.2.0 (GKE)",
    "CIS v1.3.0 (GKE) - Level 1",
    "CSA CCM v.4.0.1",
    "CSA CCM v3.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HIPAA",
    "ISO 27001:2013",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}