{
  "policyUpi": "PC-AWS-S3-636",
  "policyId": "55b4de5f-2b59-4545-ac0c-f4ebad2e3add",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "high",
  "name": "AWS S3 bucket publicly writable",
  "description": "This policy identifies the S3 buckets that are publicly writable by Put/Create/Update/Replicate/Write/Delete bucket operations. These permissions permit anyone, malicious or not, to Put/Create/Update/Replicate/Write/Delete bucket operations on your S3 bucket if they can guess the namespace. S3 service does not protect the namespace if ACLs and Bucket policy is not handled properly, with this configuration you may be at risk of compromise of critical data by leaving S3 public.\n\nFor more details:\nhttps://docs.aws.amazon.com/AmazonS3/latest/user-guide/set-permissions.html\nhttps://docs.aws.amazon.com/AmazonS3/latest/dev/about-object-ownership.html#ensure-object-ownership ",
  "rule.criteria": "1c513ad3-7db5-4fbf-abdd-39969f222f13",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-s3api-get-bucket-acl' AND json.rule = ((((publicAccessBlockConfiguration.ignorePublicAcls is false and accountLevelPublicAccessBlockConfiguration does not exist) or (publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration.ignorePublicAcls is false) or (publicAccessBlockConfiguration.ignorePublicAcls is false and accountLevelPublicAccessBlockConfiguration.ignorePublicAcls is false)) and (acl.grantsAsList[?any(grantee equals AllUsers and permission is member of (WriteAcp,Write,FullControl))] exists or acl.grantsAsList[?any(grantee equals AuthenticatedUsers and permission is member of (WriteAcp,Write,FullControl))] exists)) or ((policyStatus.isPublic is true and ((publicAccessBlockConfiguration.restrictPublicBuckets is false and accountLevelPublicAccessBlockConfiguration does not exist) or (publicAccessBlockConfiguration does not exist and accountLevelPublicAccessBlockConfiguration.restrictPublicBuckets is false) or (publicAccessBlockConfiguration.restrictPublicBuckets is false and accountLevelPublicAccessBlockConfiguration.restrictPublicBuckets is false))) and (policy.Statement[?any(Effect equals Allow and (Principal equals * or Principal.AWS equals *) and (Action contains s3:* or Action contains s3:Put or Action contains s3:Create or Action contains s3:Replicate or Action contains s3:Update or Action contains s3:Delete) and (Condition does not exist))] exists))) and websiteConfiguration does not exist",
  "recommendation": "1. Log in to the AWS Console\n2. Navigate to the 'S3' service\n3. Click on the S3 resource reported in the alert\n4. Click on the 'Permissions' tab\n5. If Access Control List is set to 'Public' follow the below steps\na. Under 'Access Control List', Click on 'Everyone' and uncheck all items\nb. Under 'Access Control List', Click on 'Authenticated users group' and uncheck all items\nc. Click on Save changes\n6. If 'Bucket Policy' is set to public follow the below steps\na. Under 'Bucket Policy', Select 'Edit Bucket Policy' and consider defining what explicit 'Principal' should have the ability to PUT/CREATE/REPLICATE/DELETE objects in your S3 bucket. You may also want to specifically limit the 'Principal' ability to perform specific PUT/CREATE/REPLICATE/DELETE functions, without the wild card.\nIf 'Bucket Policy' is not required delete the existing 'Bucket Policy'.\nb. Click on Save changes\n\nNote: Make sure updating 'Access Control List' or 'Bucket Policy' does not affect S3 bucket data access.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "AWS Foundational Security Best Practices standard",
    "AWS Well-Architected Framework",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "Insurance Regulatory And Development Authority Of India",
    "Korea â€“ Information Security Management System (ISMS)",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0 [Deprecated]",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v8.2 [Deprecated]",
    "MLPS 2.0 (Level 2)",
    "NIST 800-53 Rev 5",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Risk Management in Technology (RMiT)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA"
  ]
}