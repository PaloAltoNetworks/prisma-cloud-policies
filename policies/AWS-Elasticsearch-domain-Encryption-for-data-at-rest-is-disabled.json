{
  "policyUpi": "PC-AWS-ES-174",
  "policyId": "0a54c279-d08a-4443-a93b-6d109addd964",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS Elasticsearch domain Encryption for data at rest is disabled",
  "description": "This policy identifies Elasticsearch domains for which encryption is disabled. Encryption of data at rest is required to prevent unauthorized users from accessing the sensitive information available on your Elasticsearch domains components. This may include all data of file systems, primary and replica indices, log files, memory swap files and automated snapshots. The Elasticsearch uses AWS KMS service to store and manage the encryption keys. It is highly recommended to implement encryption at rest when you are working with production data that have sensitive information, to protect from unauthorized access.",
  "rule.criteria": "bbd8196f-89c4-4018-8f28-cbad9e2a6841",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-es-describe-elasticsearch-domain' AND json.rule = 'processing is false and (encryptionAtRestOptions.enabled is false or encryptionAtRestOptions does not exist)'",
  "recommendation": "Enabling the encryption feature on existing domains requires Elasticsearch 6.7 or later. If your Elasticsearch 6.7 or later, follow below steps to enable encryption on existing Elasticsearch domain:\n1. Sign into the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to Elasticsearch Service Dashboard\n4. Choose reported Elasticsearch domain\n5. Click on 'Actions' button, from drop-down select 'Modify encryptions'\n6.In Modify encryptions page, Select the 'Enable encryption of data at rest' checkbox and Choose KMS key as per your requirement. It is recommended to choose KMS CMKs instead of default KMS [Default(aws/es)]; to get more grannular control on your Elasticsearch domain data.\n7. Click on 'Submit'.\n\nIf your Elasticsearch is less than 6.7 version, then AWS Elasticsearch Domain encryption can be set only at the time of the creation of domain. So to fix this alert, create a new domain with encryption using KMS Keys and then migrate all required Elasticsearch domain data from the reported Elasticsearch domain to this newly created domain.\nTo set up the new Elasticsearch domain with encryption using KMS Key, refer the following URL:\nhttps://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html\n\nTo delete reported ES domain, refer the following URL:\nhttps://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-gsg-deleting.html",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "AWS Foundational Security Best Practices standard",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CRI Profile v2.0",
    "CSA CCM v3.0.1",
    "CSA CCM v4.0.12",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "DORA",
    "FFIEC",
    "Fedramp (Moderate)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "HITRUST CSF v9.3 [Deprecated]",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27001:2013",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Korea â€“ Information Security Management System (ISMS)",
    "MAS TRM 2021",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Risk Management in Technology (RMiT)",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2"
  ]
}