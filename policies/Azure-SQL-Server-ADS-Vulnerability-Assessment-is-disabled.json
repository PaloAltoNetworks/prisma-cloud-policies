{
  "policyUpi": "PC-AZR-SQL-655",
  "policyId": "b805e5f2-8479-4197-82ce-9d8fcdf38a44",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure SQL Server ADS Vulnerability Assessment is disabled",
  "description": "This policy identifies Azure SQL Server which has ADS Vulnerability Assessment setting disabled. Advanced Data Security - Vulnerability Assessment service scans SQL databases for known security vulnerabilities and highlight deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. It is recommended to enable ADS - VA service and configure storage account to store the scanning data and reports.",
  "rule.criteria": "5ce54350-2196-4124-825e-01d4bd407f49",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-sql-server-list' AND json.rule = vulnerabilityAssessments[*].properties.storageContainerPath does not exist",
  "recommendation": "1. Log in to the Azure portal\n2. Select 'SQL servers', and select the SQL server you need to modify\n3. Click on 'Security Center' under Security\n4. Click on 'Enable Azure Defender for SQL' if Azure Defender is not enabled for SQL already\n5. Click on '(Configure)' next to 'Azure Defender for SQL: Enabled at the server-level'\n6. Ensure that 'AZURE DEFENDER FOR SQL' status is 'ON'\n7. Click on 'Storage account' under 'VULNERABILITY ASSESSMENT SETTINGS' and choose the storage account to store scanning data and reports\n8. 'Save' your changes",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "NIST SP 800-171 Revision 2",
    "PCI DSS v3.2.1"
  ]
}