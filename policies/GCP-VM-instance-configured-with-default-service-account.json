{
  "policyUpi": "PC-GCP-GCE-556",
  "policyId": "68ab0618-0716-11eb-adc1-0242ac120002",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP VM instance configured with default service account",
  "description": "GCP VM instances using the default service account present a significant security risk. Using the default service account grants attackers broad project-level access if the VM is compromised.\n\nThe default Compute Engine service account possesses the 'Editor' role, providing extensive privileges within the Google Cloud Project. Failing to use a custom service account with restricted permissions allows attackers to potentially escalate privileges, exfiltrate data, or deploy malicious software. This misconfiguration exposes the entire project to compromise.\n\nExploiting this misconfiguration can lead to complete project takeover. Attackers could gain full control of all resources, leading to data breaches, service disruptions, and financial losses. Restricting service account permissions is crucial for mitigating lateral movement and limiting the blast radius of a potential compromise.\n\nTo remediate this, create and use custom service accounts for each Virtual Machine instance. Grant only the necessary permissions to these accounts using the principle of least privilege. Regularly review and update these permissions to ensure they remain appropriate and minimize risk.",
  "rule.criteria": "6f326cc0-c19e-4d9d-9cbc-e226dd6b58eb",
  "searchModel.query": "config from cloud.resource where api.name = 'gcloud-projects-get-iam-user' AND json.rule = user contains \"compute@developer.gserviceaccount.com\" and roles[*] contains \"roles/editor\" as X; config from cloud.resource where api.name = 'gcloud-compute-instances-list' AND json.rule = (status equals RUNNING and name does not start with \"gke-\") and serviceAccounts[?any( email contains \"compute@developer.gserviceaccount.com\")] exists as Y; filter '$.Y.serviceAccounts[*].email contains $.X.user'; show Y;",
  "recommendation": "Log in to GCP Console\n2. Navigate to 'Compute Engine' and click on 'VM instances'\n3. Search for the alerted instance and click on the instance name\n4. To make a change first we have to stop the instance; click on 'STOP' from the top menu\n5. Click on 'EDIT' and Go to section 'Service account' \n6. From the dropdown select a non-default service account \n7. Click on 'Save'\n8. Click on 'START/RESUME' from the top menu",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Cyber Security Centre (ACSC) Essential Eight",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 1",
    "CIS v3.0.0 (GCP) Level 1",
    "CRI Profile v2.0",
    "CSA CCM v.4.0.1",
    "Cloud Security Assurance Program (CSAP) - IaaS",
    "Cloud Security Assurance Program (CSAP) - Low",
    "Cloud Security Assurance Program (CSAP) - Low SaaS",
    "Cloud Security Assurance Program (CSAP) - SaaS Simplified",
    "Cloud Security Assurance Program (CSAP) - SaaS Standard",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "Microsoft Cloud Security Benchmark v1",
    "NCSC - Cyber Essentials",
    "NCSC Cloud Security Principles",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}