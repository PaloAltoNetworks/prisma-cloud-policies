{
  "policyUpi": "PC-GCP-GCE-556",
  "policyId": "68ab0618-0716-11eb-adc1-0242ac120002",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP VM instance configured with default service account",
  "description": "This policy identifies GCP VM instances configured with the default service account. To defend against privilege escalations if your VM is compromised and prevent an attacker from gaining access to all of your project, it is recommended to not use the default Compute Engine service account because it has the Editor role on the project.",
  "rule.criteria": "6f326cc0-c19e-4d9d-9cbc-e226dd6b58eb",
  "searchModel.query": "config from cloud.resource where api.name = 'gcloud-projects-get-iam-user' AND json.rule = user contains \"compute@developer.gserviceaccount.com\" and roles[*] contains \"roles/editor\" as X; config from cloud.resource where api.name = 'gcloud-compute-instances-list' AND json.rule = (status equals RUNNING and name does not start with \"gke-\") and serviceAccounts[?any( email contains \"compute@developer.gserviceaccount.com\")] exists as Y; filter '$.Y.serviceAccounts[*].email contains $.X.user'; show Y;",
  "recommendation": "Log in to GCP Console\n2. Navigate to 'Compute Engine' and click on 'VM instances'\n3. Search for the alerted instance and click on the instance name\n4. To make a change first we have to stop the instance; click on 'STOP' from the top menu\n5. Click on 'EDIT' and Go to section 'Service account' \n6. From the dropdown select a non-default service account \n7. Click on 'Save'\n8. Click on 'START/RESUME' from the top menu",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Cyber Security Centre (ACSC) Essential Eight",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 1",
    "CIS v3.0.0 (GCP) Level 1",
    "CRI Profile v2.0",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "Microsoft Cloud Security Benchmark v1",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}