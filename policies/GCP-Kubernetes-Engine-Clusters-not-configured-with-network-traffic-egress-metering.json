{
  "policyUpi": "PC-GCP-GKE-367",
  "policyId": "dd7a6aaf-e5bb-4a24-a187-37f4d9686feb",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP Kubernetes Engine Clusters not configured with network traffic egress metering",
  "description": "This policy identifies Kubernetes Engine Clusters which are not configured with network traffic egress metering. When network traffic egress metering enabled, deployed DaemonSet pod meters network egress traffic by collecting data from the conntrack table, and exports the metered metrics to the specified destination. It is recommended to use, network egress metering so that you will be having data and track over monitored network traffic.\n\nNOTE: Measuring network egress requires a network metering agent (NMA) running on each node. The NMA runs as a privileged pod, consumes some resources on the node (CPU, memory, and disk space), and enables the nf_conntrack_acct sysctl flag on the kernel (for connection tracking flow accounting). If you are comfortable with these caveats, you can enable network egress tracking for use with GKE usage metering.",
  "rule.criteria": "76a3fc59-1e56-4212-8e4f-bbbd86814548",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-container-describe-clusters' AND json.rule =  'resourceUsageExportConfig.enableNetworkEgressMetering does not exist or resourceUsageExportConfig.enableNetworkEgressMetering is false'",
  "recommendation": "Follow the below mentioned URL to enable GKE usage metering:\n\nhttps://cloud.google.com/kubernetes-engine/docs/how-to/cluster-usage-metering#enabling",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CSA CCM v.4.0.1",
    "CSA CCM v.4.0.6",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "FFIEC",
    "HITRUST v.9.4.2",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}