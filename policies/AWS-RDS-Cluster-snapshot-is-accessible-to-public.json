{
  "policyUpi": "PC-AWS-RDS-823",
  "policyId": "c3b4aa16-0d31-4cfb-9350-00b200006ace",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS RDS Cluster snapshot is accessible to public",
  "description": "This policy identifies AWS RDS Cluster snapshots which is accessible to public. Amazon Relational Database Service (Amazon RDS) is a web service that makes it easier to setup and manage databases. If RDS Cluster snapshots are inadvertently shared to public, any unauthorized user with AWS console access can gain access to the snapshots and gain access to sensitive data.",
  "rule.criteria": "4db5ec62-c7cd-4725-adba-fdd30eb911a3",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' and api.name= 'aws-rds-db-cluster-snapshots' AND json.rule = dbclusterSnapshotAttributes[?any( attributeName equals restore and attributeValues[*] contains \"all\" )] exists",
  "recommendation": "1. Sign in to the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to the 'RDS' service\n4. Click on 'Snapshots'\n5. Under 'Manual' tab select the reported RDS Cluster\n6. Click on 'Actions' and select 'Share snapshot'\n7. Under 'DB snapshot visibility' select 'Private'\n8. Click on 'Save'",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws rds modify-db-cluster-snapshot-attribute --region ${region} --db-cluster-snapshot-identifier ${resourceId} --attribute-name restore --values-to-remove \"all\"",
  "remediation.description": "This CLI command requires 'rds:ModifyDBClusterSnapshotAttribute' permission. Successful execution will reset this RDS Cluster snapshot ACL (Access Control List) to private. This will ensure that only Owner has full privileges.",
  "remediation.impact": "RDS snapshot share public to private",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Korea â€“ Information Security Management System (ISMS)",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MLPS 2.0 (Level 2)",
    "NIST SP 800-171 Revision 3",
    "NYDFS 23 CRR-NY 500.0",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}