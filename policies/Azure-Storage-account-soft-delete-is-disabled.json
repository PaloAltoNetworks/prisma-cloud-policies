{
  "policyUpi": "PC-AZR-STO-665",
  "policyId": "f5a29936-659e-48a8-8110-783411bf6a9c",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "low",
  "name": "Azure Storage account soft delete is disabled",
  "description": "This policy identifies Azure Storage accounts which has soft delete disabled. Azure Storage contains important access logs, financial data, personal and other secret information which is accidentally deleted by a user or application could cause data loss or data unavailability. It is recommended to enable soft delete setting in Azure Storage accounts.",
  "rule.criteria": "854edc33-62b4-46c0-83a1-2774ae9ae4ff",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = deleteRetentionPolicy.blob.enabled is false and (kind does not equal ignore case FileStorage)",
  "recommendation": "To enable Soft delete on your storage account, follow below URL:\nhttps://learn.microsoft.com/en-gb/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal#enable-blob-soft-delete",
  "remediable": true,
  "remediation.cliScriptTemplate": "az storage account blob-service-properties update --account-name ${resourceName} --resource-group ${resourceGroup} --enable-delete-retention true --delete-retention-days 30",
  "remediation.description": "This CLI command requires 'Microsoft.Storage/storageAccounts/blobServices/write' permission. Successful execution will enable soft delete for blobs on Azure Storage accounts. NOTE: As best practice we are setting delete retention days to 30 days; it can be changed based on customer requirement by cloning the policy.",
  "remediation.impact": "Enables Azure Storage accounts soft delete",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "Azure Security Benchmark (v3)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CSA CCM v.4.0.1",
    "HITRUST v.9.4.2",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MLPS 2.0 (Level 2)",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}