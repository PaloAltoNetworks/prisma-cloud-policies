{
  "policyUpi": "PC-GCP-SQL-741",
  "policyId": "b0faaf71-3c22-499c-983e-ef51ced2c8a3",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "low",
  "name": "GCP MySQL instance database flag skip_show_database is not set to on",
  "description": "This policy identifies Mysql database instances in which database flag skip_show_database is not set to on. This prevents people from using the SHOW DATABASES statement if they do not have the SHOW DATABASES privilege. This can improve security if you have concerns about users being able to see databases belonging to other users. It is recommended to set skip_show_database to on.",
  "rule.criteria": "25232585-e11e-4826-a7ad-93cc00d543da",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-sql-instances-list' AND json.rule = state equals RUNNABLE and databaseVersion contains MYSQL and (settings.databaseFlags[*].name does not contain skip_show_database or settings.databaseFlags[?any(name contains skip_show_database and value does not contain on)] exists)",
  "recommendation": "1. Log in to GCP console\n2. Navigate SQL Instances page\n3. Click on reported MYSQL instance\n4. Click on 'EDIT'\nNOTE: If the instance is stopped, You need to START instance first to edit the configurations, then Click on EDIT.\n5. If the flag has not been set on the instance, \nUnder 'Customize your instance', click on 'ADD FLAG' in 'Flags' section, choose the flag 'skip_show_database' from the drop-down menu and set the value as 'on'\nOR\nIf the flag has been set to off, Under 'Customize your instance', In 'Flags' section choose the flag 'skip_show_database' and set the value as 'on', Click on DONE\n6. Click on 'DONE' and then 'SAVE' and if popup window appears, select 'SAVE AND RESTART'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 1",
    "CIS v3.0.0 (GCP) Level 1",
    "Cloud Security Assurance Program (CSAP) - IaaS",
    "Cloud Security Assurance Program (CSAP) - SaaS Simplified",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}