{
  "policyUpi": "PC-AWS-VPC-352",
  "policyId": "706b69c8-48ee-4159-8b05-9c21e37a2070",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS Network ACLs with Outbound rule to allow All Traffic",
  "description": "This policy identifies ACLs which allows traffic on all protocols. A network access control list (ACL) is an optional layer of security for your VPC that acts as a firewall for controlling traffic in and out of one or more subnets. By default, ACL allows all inbound and outbound IPv4 traffic and, if applicable, IPv6 traffic. Outbound rules that allow unrestricted traffic to the internet can be a security risk. As a best practice, it is recommended to configure ACLs to restrict traffic on authorized protocols.",
  "rule.criteria": "c4a4a7a3-7197-4927-9144-45515e4030fe",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-ec2-describe-network-acls' and json.rule = associations[*] is not empty and entries[?any( ruleAction equals allow and protocol equals -1 and (ipv6CidrBlock equals ::/0 or cidrBlock equals 0.0.0.0/0) and egress is true )] exists",
  "recommendation": "1. Sign in to the AWS Console\n2. Go to VPC\n3. In the navigation pane, choose Network ACLs, and then select the Network ACL\n4. Choose the Outbound Rules tab, and then choose Edit\n5. Identify the unrestricted Outbound Rule having 'ALL Traffic' type and Source as 0.0.0.0/0 or ::/0\n6. Make rule restrictive or either Delete or DENY the rule by clicking on remove icon or DENY the identified rule and save it",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CSA CCM v.4.0.1",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST CSF v9.3",
    "HITRUST v.9.4.2",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "MLPS 2.0",
    "MPAA Content Protection Best Practices",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "Risk Management in Technology (RMiT)"
  ]
}