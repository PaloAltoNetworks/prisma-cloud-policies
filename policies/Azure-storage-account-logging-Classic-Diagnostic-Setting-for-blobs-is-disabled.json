{
  "policyUpi": "PC-AZR-STO-309",
  "policyId": "85a4a77f-0d46-4c3d-ae8c-37d945a0b44e",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "informational",
  "name": "Azure storage account logging (Classic Diagnostic Setting) for blobs is disabled",
  "description": "Storage Logging records details of requests (read, write, and delete operations) against your Azure blobs. The logs include additional information such as:\n- Timing and server latency.\n- Success or failure, and HTTP status code.\n- Authentication details\n\nThis policy identifies Azure storage accounts that do not have logging enabled for blobs. As a best practice, enable logging for read, write, and delete request types on blobs.\n\nNote: In case a customer is using Non-Classic Diagnostic Settings, they can disable this policy.",
  "rule.criteria": "56a50f39-4dc9-4af2-a9cb-4407cdaa191f",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-storage-account-list' AND json.rule = 'sku.tier equals Standard and (loggingProperties.blob.readEnabled is false or loggingProperties.blob.writeEnabled is false or loggingProperties.blob.deleteEnabled is false)'",
  "recommendation": "1. Log in to the Azure portal.\n2. Select 'Storage Accounts'.\n3. Select the storage account you need to modify.\n4. Select 'Diagnostic Logs (classic)'.\n5. Set the 'status' to 'On'.\n6. Select 'Blob properties' tab.\n7. Enable 'Logging' for the three operations - 'Read', 'Write', 'Delete'.\n8. (Optionally) Select 'Delete data', and specify the number of days for which to retain data.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Azure Security Benchmark (v2)",
    "Azure Security Benchmark (v3)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CIS v1.3.1 (Azure)",
    "CIS v1.4.0 (Azure)",
    "CIS v1.5.0 (Azure) - Level 2",
    "CIS v2.0.0 (Azure) Level 2",
    "CSA CCM v.4.0.1",
    "CSA CCM v.4.0.6",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "FFIEC",
    "Fedramp (Moderate)",
    "HITRUST v.9.4.2",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "MLPS 2.0 (Level 2)",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}