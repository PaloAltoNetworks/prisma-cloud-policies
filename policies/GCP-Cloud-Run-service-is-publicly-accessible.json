{
  "policyUpi": "PC-GCP-CLR-934",
  "policyId": "f4ff0156-ce21-42ab-aa20-490c3159ecb9",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Cloud Run service is publicly accessible",
  "description": "Publicly accessible GCP Cloud Run services pose a significant security risk, allowing unauthorized access to sensitive data and potential service disruptions.\n\nCloud Run services are configured to allow invocation via HTTP requests. Granting the 'Cloud Run Invoker' permission to 'allUsers' or 'allAuthenticatedUsers' exposes the service to the public internet. Attackers could exploit this misconfiguration to gain unauthorized access, leading to data breaches, service disruption, or malicious code execution.\n\nThe impact ofthis misconfiguration includes data breaches, unauthorized resource access, and potential service compromise. Restricting access to only authorized users and services ensures that only legitimate requests can interact with the Cloud Run service, mitigating these risks. Least privilege access control is crucial for enhanced security.\n\nTo remediate this, restrict access to the Cloud Run service. Grant the 'Cloud Run Invoker' role only to specific service accounts or users as needed, and avoid granting it to 'allUsers' or 'allAuthenticatedUsers' unless explicitly required for a publicly accessible API. Regularly review and update permissions to maintain a strong security posture.",
  "rule.criteria": "a7245ab6-cee9-450e-bd24-e87ae0a28ccb",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-cloud-run-services-list' AND json.rule = status.conditions[?any(type equals Ready and status equals True)] exists and status.conditions[?any(type equals RoutesReady and status equals True)] exists and iamPolicy.bindings[?any(role equals roles/run.invoker and members is member of (allUsers, allAuthenticatedUsers))] exists",
  "recommendation": "It is recommended to review and add appropriate, but restrictive roles before revoking access.\n\nTo revoke access from 'allusers'/'allAuthenticatedUsers', refer to the following URL:\nhttps://cloud.google.com/run/docs/securing/managing-access#remove-principals",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM) (Latest)",
    "CIS Controls v8.1",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Korea â€“ Information Security Management System (ISMS)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST 800-53 Rev 5",
    "NYDFS 23 CRR-NY 500.0",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v4.0.1",
    "Risk Management in Technology (RMiT)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}