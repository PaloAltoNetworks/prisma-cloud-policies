{
  "policyUpi": "PC-AZR-AGW-555",
  "policyId": "f552fc4a-b210-4ec1-adfe-c29350a04f92",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure Application gateways listener that allow connection requests over HTTP",
  "description": "This policy identifies Azure Application gateways that are configured to accept connection requests over HTTP. As a best practice, use the HTTPS protocol to encrypt the communication between the application clients and the application gateways.",
  "rule.criteria": "864d0191-9e8f-46d0-9b3d-f76680579ff6",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-application-gateway' AND json.rule = ['properties.httpListeners'][*].['properties.protocol'] equals Http",
  "recommendation": "1. Log in to the Azure Portal\n2. Select 'All services'\n3. Select 'Application gateways', under NETWORKING\n4. Select the Application gateways needed to be modified\n5. Select 'Listeners' under Settings\n6. To add HTTPS listener follow below step, if already HTTPS listener present jump to point 10\n7. Click on 'Add listener', enter 'Listener name', 'Frontend IP'\n8. Select 'Protocol' as HTTPS and fill in 'Https Settings' and 'Additional settings' and click on 'Add'\n9. Click on 'Rules' in the left pane and click on 'Request routing rule' and associate HTTPS listener to a rule \n10. Click on three dots on the right corner of a row containing 'Protocol' as HTTP\n11. Click on 'Delete'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v.4.0.1",
    "CSA CCM v.4.0.6",
    "CSA CCM v4.0.12",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "DORA",
    "FFIEC",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "Korea â€“ Information Security Management System (ISMS)",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "NIST 800-53 Rev 5",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}