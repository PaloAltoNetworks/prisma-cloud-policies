{
  "policyUpi":"PC-GCP-VPC-68",
  "policyId":"b1a3c396-2e03-4050-b7b4-6cf8a7ab5f9b",
  "policyType":"config",
  "cloudType":"gcp",
  "severity":"high",
  "name":"GCP Firewall rule allows internet traffic to PostgreSQL port (5432)",
  "description":"This policy identifies GCP Firewall rules which allows inbound traffic on PostgreSQL port (5432) from public internet. Allowing access from arbitrary internet IP addresses to this port increases the attack surface of your network.",
  "rule.criteria":"b1a3c396-2e03-4050-b7b4-6cf8a7ab5f9b",
  "searchModel.query":"config from cloud.resource where api.name='gcloud-compute-firewall-rules-list' AND json.rule='sourceRanges[*] contains 0.0.0.0\/0 and allowed[*].ports[*] contains _Port.inRange(5432,5432) or (sourceRanges[*] contains 0.0.0.0\/0 and allowed[*].ports[*] size less than 1 and allowed[*].IPProtocol contains tcp) or (sourceRanges[*] contains 0.0.0.0\/0 and allowed[*].ports[*] size less than 1 and allowed[*].IPProtocol contains udp)'",
  "recommendation":"If the Firewall rule reported indeed need to restrict all traffic, follow the instructions below:\n1. Login to GCP Console\n2. Go to VPC Network\n3. Go to the Firewall rules\n4. Click on the reported Firewall rule\n5. Click Edit\n6. Modify Source IP ranges to specific IP\n7. Click Save",
  "remediable":true,
  "remediation.cliScriptTemplate":"gcloud -q compute --project=${account} firewall-rules delete ${resourceName}",
  "remediation.description":"This CLI command requires 'gcloud.compute.firewall-rules.delete' permission. Successful execution will delete this firewall rule blocking internet traffic to PostgreSQL port (5432).",
  "remediation.impact":"delete this firewall rule",
  "compliance.standard":[
    "CCPA 2018",
    "CSA CCM v3.0.1",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "MITRE ATT&CK [Beta]",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "PCI DSS v3.2",
    "PIPEDA",
    "SOC 2"
  ]
}