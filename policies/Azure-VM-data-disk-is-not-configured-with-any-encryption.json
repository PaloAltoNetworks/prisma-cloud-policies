{
  "policyUpi": "PC-AZR-CMP-943",
  "policyId": "b3a1230c-4a9f-4493-bfe4-c388a2e775d4",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "low",
  "name": "Azure VM data disk is not configured with any encryption",
  "description": "This policy identifies VM data disks that are not configured with any encryption. Azure encrypts data disks that are not configured with any encryption. Azure offers Server-Side Encryption (SSE) with platform-managed keys [SSE with PMK] by default for managed disks. It is recommended to enable default encryption or you may optionally choose to use a customer-managed key to protect from malicious activity.",
  "rule.criteria": "7429c748-6df8-4f6f-8231-8718ce02477b",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-disk-list' AND json.rule = osType does not exist and managedBy exists and (encryptionSettings does not exist or encryptionSettings.enabled is false) and encryption.type is not member of (\"EncryptionAtRestWithCustomerKey\", \"EncryptionAtRestWithPlatformAndCustomerKeys\",\"EncryptionAtRestWithPlatformKey\")",
  "recommendation": "1. Log in to the Azure Portal\n2. Navigate to 'Disks'\n3. Select the reported OS disk you want to modify\n4. Select 'Encryption' under 'Settings'\n5. Select 'Encryption Type' according to your encryption requirement.\n6. Click on 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CIS Controls v8.1",
    "CSA CCM v4.0.12",
    "DORA",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "MLPS 2.0 (Level 2)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST 800-53 Rev 5",
    "NYDFS 23 CRR-NY 500.0",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}