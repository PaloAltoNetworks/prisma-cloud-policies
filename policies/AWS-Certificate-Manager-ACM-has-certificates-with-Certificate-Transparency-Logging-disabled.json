{
  "policyUpi": "PC-AWS-ACM-165",
  "policyId": "546a493a-3979-42d1-a018-e07dbfc15ae6",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS Certificate Manager (ACM) has certificates with Certificate Transparency Logging disabled",
  "description": "This policy identifies AWS Certificate Manager certificates in which Certificate Transparency Logging is disabled. AWS Certificate Manager (ACM) is the preferred tool to provision, manage, and deploy your server certificates. Certificate Transparency Logging is used to guard against SSL/TLS certificates that are issued by mistake or by a compromised CA, some browsers require that public certificates issued for your domain can also be recorded. This policy generates alerts for certificates which have transparency logging disabled. As a best practice, it is recommended to enable Transparency logging for all certificates.",
  "rule.criteria": "84870f04-0516-4cc1-b5b7-2abf9ad4a283",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-acm-describe-certificate' AND json.rule = 'type does not equal IMPORTED and (options.certificateTransparencyLoggingPreference equals DISABLED or options.certificateTransparencyLoggingPreference does not exist) and status equals ISSUED and _DateTime.ageInDays($.notAfter) < 1'",
  "recommendation": "You cannot currently use the console to opt out of or into transparency logging. It's recommended to use the command line utility to enable transparency logging.\n\nRemediation CLI:\n1. Use the below command to list ACM certificate\n\taws acm list-certificates\n2. Note the 'CertificateArn' of the reported ACM certificate\n3. Use the below command to ENABLE Certificate Transparency Logging\n\taws acm update-certificate-options --certificate-arn <certificateARN> --options CertificateTransparencyLoggingPreference=ENABLED\nwhere 'CertificateArn' is captured in the step2",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws acm update-certificate-options --region ${region} --certificate-arn ${certificateArn} --options CertificateTransparencyLoggingPreference=ENABLED",
  "remediation.description": "This CLI command requires 'acm:UpdateCertificateOptions' permission. Successful execution will enable Certificate Transparency Logging for AWS Certificate Manager (ACM) certificates.",
  "remediation.impact": "Enables AWS Certificate Manager (ACM) certificate with Certificate Transparency Logging",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CSA CCM v3.0.1",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "FFIEC",
    "Fedramp (Moderate)",
    "GDPR",
    "HITRUST CSF v.9.6.0",
    "HITRUST CSF v9.3",
    "HITRUST v.9.4.2",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0",
    "MLPS 2.0",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "Risk Management in Technology (RMiT)",
    "SOC 2"
  ]
}