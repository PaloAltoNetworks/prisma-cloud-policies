{
  "policyUpi": "PC-GCP-FUN-930",
  "policyId": "34836a26-00ef-4e29-80f7-93e16611f0a5",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Cloud Function is publicly accessible",
  "description": "Publicly accessible GCP Google Cloud Functions pose a significant security risk. Unsecured cloud functions can be invoked by unauthorized users, potentially leading to data breaches or service disruptions.\n\nCloud Functions, by default, should not be publicly accessible. Enabling public access without proper authentication and authorization mechanisms exposes the function to malicious actors. Attackers could exploit this misconfiguration to execute arbitrary code, access sensitive data, or perform denial-of-service attacks.\n\nThe impact of this misconfiguration could range from unauthorized data access and modification to complete system compromise. Restricting access to only authorized users and services through appropriate authentication and authorization mechanisms is crucial for maintaining data confidentiality, integrity, and availability.\n\nTo remediate this risk, ensure Cloud Functions are configured with appropriate Identity and Access Management (IAM) roles. Grant only the necessary roles to specific service accounts or users. Regularly review and audit the access granted to Cloud Functions to maintain a strong security posture.",
  "rule.criteria": "9d657a8a-6c31-4bb5-8bb8-d0d55d04263b",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-cloud-function' AND json.rule = status equals ACTIVE and iamPolicy.bindings[?any(members[*] is member of (\"allAuthenticatedUsers\",\"allUsers\"))] exists",
  "recommendation": "It is recommended to review and add appropriate, but restrictive roles before revoking access.\n\nTo revoke access from 'allusers'/'allAuthenticatedUsers', follow the below mentioned steps:\n1. Login to GCP console\n2. Navigate to service 'Cloud Functions'\n3. Click on the function on which the alert is generated\n4. Go to tab 'PERMISSIONS'\n5. Review the roles to see if 'allusers'/'allAuthenticatedUsers' is present\n6. Click on the delete icon to revoke access from 'allusers'/'allAuthenticatedUsers'\n7. On Pop-up select the check box to confirm \n8. Click on 'REMOVE'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM) (Latest)",
    "CIS Controls v8.1",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Korea â€“ Information Security Management System (ISMS)",
    "NIST 800-53 Rev 5",
    "NYDFS 23 CRR-NY 500.0",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v4.0.1",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}