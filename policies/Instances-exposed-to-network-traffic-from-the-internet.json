{
  "policyUpi": "PC-ALL-ALL-36",
  "policyId": "9c7af8a8-5743-420f-a879-8f0f73d678ea",
  "policyType": "network",
  "cloudType": "all",
  "severity": "high",
  "name": "Instances exposed to network traffic from the internet",
  "description": "This policy identifies network traffic coming from the internet to sensitive cloud workloads. Cloud workloads should have appropriate Security Groups and ACLs in place so that only external facing workloads such as load balancers, web servers, bastion hosts are exposed to the internet. Cloud workloads with internet exposure are vulnerable to external threats.\n\nNote: This policy alerts AWS and GCP workloads correctly and for Azure, it may trigger alerts for NAT Gateway configured resources also.",
  "rule.criteria": "b13f6181-3cd7-4c97-9420-29498cb28277",
  "searchModel.query": "network from vpc.flow_record where src.publicnetwork IN ('Suspicious IPs','Internet IPs') AND dest.resource IN ( resource where role not in ( 'AWS NAT Gateway' , 'AWS ELB', 'AZURE ELB', 'GCP ELB' ) ) and protocol not in ( 'ICMP' , 'ICMP6' ) AND accepted.bytes > 0",
  "recommendation": "1. Log in to the Cloud Console\n2. Search for the resource reported in the alert\n3. Check if the Security Group/Firewall Rule of the resource indeed allows connections from the internet\n4. Assign another Security Group/Firewall Rule to the resource that has a more restrictive ACL, which does not permit connection from the internet",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CCPA 2018",
    "CSA CCM v3.0.1",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v9.3",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "SOC 2"
  ]
}