{
  "policyUpi": "PC-GCP-LB-388",
  "policyId": "0c75048b-54fd-4b6c-8eab-f6226e94ec96",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP HTTPS Load balancer is configured with SSL policy having TLS version 1.1 or lower",
  "description": "This policy identifies HTTPS Load balancers is configured with SSL policy having TLS version 1.1 or lower. As a best security practice, use TLS 1.2 as the minimum TLS version in your load balancers SSL security policies.",
  "rule.criteria": "0f4d94c1-a1c4-43d3-afe1-d08d581a7ddc",
  "searchModel.query": "config from cloud.resource where api.name = 'gcloud-compute-ssl-policies' as X; config from cloud.resource where api.name = 'gcloud-compute-target-https-proxies' as Y; filter \"($.Y.sslPolicy exists and $.X.sslPolicies is not empty) and ($.X.sslPolicies[?(@.minTlsVersion!='TLS_1_2')].selfLink contains $.Y.sslPolicy)\" ; show Y;",
  "recommendation": "1. Login to GCP Portal\n2. Go to Network services (Left Panel)\n3. Select Load balancing\n4. Click on 'advanced menu' hyperlink to view target proxies\n5. Click on 'Target proxies' tab\n6. Click on the reported HTTPS target proxy\n7. Click on the hyperlink under 'URL map'\n8. Click on the 'EDIT' button\n9. Select 'Frontend configuration', Click on HTTPS protocol rule\n10. Select SSL policy which uses TLS 1.2 version or create a new SSL policy with TLS 1.2 as Minimum TLS version from the dropdown for 'SSL policy'\n11. Click on 'Done'\n12. Click on 'Update'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "CCPA 2018",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "PIPEDA"
  ]
}