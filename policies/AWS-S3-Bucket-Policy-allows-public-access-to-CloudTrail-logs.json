{
  "policyUpi": "PC-AWS-S3-313",
  "policyId": "a5fe47e1-54f3-47e1-a2a3-deedfb2f70b2",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS S3 Bucket Policy allows public access to CloudTrail logs",
  "description": "This policy scans your bucket policy that is applied to the S3 bucket to prevent public access to the CloudTrail logs. CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. Bucket policy or the access control list (ACL) applied to the S3 bucket does not prevent public access to the CloudTrail logs. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that stores CloudTrail logs prevents public access. Allowing public access to CloudTrail log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.",
  "rule.criteria": "8d5fb79e-88d7-48a2-a7cf-89345197ad17",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-cloudtrail-describe-trails' as X; config from cloud.resource where api.name = 'aws-s3api-get-bucket-acl' as Y; filter \"($.Y.bucketName==$.X.s3BucketName) and ($.Y.acl.grants[*].grantee contains AllUsers or $.Y.acl.grants[*].permission contains FullControl) and ($.Y.policy.Statement[?(@.Principal=='*' && @.Effect=='Allow')].Action contains s3:* or $.Y.policy.Statement[?(@.Principal.AWS=='*' && @.Effect=='Allow')].Action contains s3:*)\" ; show Y;",
  "recommendation": "1. Sign in to the AWS Console\n2. Goto S3\n3. Choose the reported S3 bucket and click Properties\n4. In the Properties pane, click the Permissions tab.\n5. If the Edit bucket policy button is present, select it.\n6. Remove any statement having an effect Set to 'Allow' and a principal set to '*'.\nNote: We recommend that you do not configure CloudTrail to write into an S3 bucket that resides in a different AWS account.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v.4.0.1",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "DORA",
    "Fedramp (Low)",
    "Fedramp (Moderate)",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0 [Deprecated]",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v6.3 [Deprecated]",
    "MITRE ATT&CK v8.2 [Deprecated]",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Risk Management in Technology (RMiT)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}