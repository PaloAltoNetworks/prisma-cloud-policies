{
  "policyUpi": "PC-GCP-LB-895",
  "policyId": "d97de551-06ce-4248-ac1b-3f0a4d9b35a8",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP Load Balancer HTTPS proxy permits SSL policies with weak cipher suites",
  "description": "This policy identifies GCP HTTPS Load Balancers that permit SSL policies with weak cipher suites. GCP default SSL policy uses a minimum TLS version of 1.0 and a Compatible profile, which allows the widest range of insecure cipher suites. \n\nTo prevent usage of insecure features, SSL policies should use at least TLS 1.2 with the MODERN profile; or  the RESTRICTED profile, because it effectively requires clients to use TLS 1.2 regardless of the chosen minimum TLS version; or a CUSTOM profile that does not support any of the following features:\n\nTLS_RSA_WITH_AES_128_GCM_SHA256\nTLS_RSA_WITH_AES_256_GCM_SHA384\nTLS_RSA_WITH_AES_128_CBC_SHA\nTLS_RSA_WITH_AES_256_CBC_SHA\nTLS_RSA_WITH_3DES_EDE_CBC_SHA",
  "rule.criteria": "079a511f-f3ee-4f27-b0f4-a8be55c3f2e7",
  "searchModel.query": "config from cloud.resource where api.name = 'gcloud-compute-target-https-proxies' as X; config from cloud.resource where api.name = 'gcloud-compute-ssl-policies' as Y; filter \"($.Y.sslPolicies[?(@.profile=='COMPATIBLE')].selfLink contains $.X.sslPolicy) or ($.Y.sslPolicies[?((@.profile=='MODERN'||@.profile=='CUSTOM') && (@.minTlsVersion!='TLS_1_2'))].selfLink contains $.X.sslPolicy or ($.Y.sslPolicies[?(@.profile=='CUSTOM' && 'TLS_RSA_WITH_AES_128_GCM_SHA256' in @.enabledFeatures)].selfLink contains $.X.sslPolicy or $.Y.sslPolicies[?(@.profile=='CUSTOM' && 'TLS_RSA_WITH_AES_256_GCM_SHA384' in @.enabledFeatures)].selfLink contains $.X.sslPolicy or $.Y.sslPolicies[?(@.profile=='CUSTOM' && 'TLS_RSA_WITH_AES_128_CBC_SHA' in @.enabledFeatures)].selfLink contains $.X.sslPolicy or $.Y.sslPolicies[?(@.profile=='CUSTOM' && 'TLS_RSA_WITH_AES_256_CBC_SHA' in @.enabledFeatures)].selfLink contains $.X.sslPolicy or $.Y.sslPolicies[?(@.profile=='CUSTOM' && 'TLS_RSA_WITH_3DES_EDE_CBC_SHA' in @.enabledFeatures)].selfLink contains $.X.sslPolicy))\"; show X;",
  "recommendation": "The 'GCP default' SSL policy uses a minimum TLS version of 1.0 and a Compatible profile, which allows the broadest range of insecure cipher suites and is not modifiable. If this SSL policy is attached to the target HTTPS Proxy Load Balancer, updating the proxy with a more secured SSL policy is recommended.\n\nTo create a new SSL policy, refer to the following URL:\nhttps://cloud.google.com/load-balancing/docs/use-ssl-policies#creating_ssl_policies\n\nTo modify the existing insecure SSL policy attached to the Target HTTPS Proxy:\n1. Login to GCP Portal\n2. Go to Network services (Left Panel)\n3. Select Load balancing\n4. Click on 'load balancing components view' hyperlink at bottom of page to view target proxies\n5. Go to 'TARGET PROXIES' tab and Click on the reported HTTPS target proxy\n6. Note the 'Load balancer' name.\n7. Click on the hyperlink under 'In use by'\n8. Note the 'External IP address'\n9. Select Load Balancing (Left Panel) and click on the HTTPS load balancer with same name as previously noted 'Load balancer' name.\n10. In frontend section, consider the rule where 'IP:Port' matches the previously noted 'External IP address'.\n11. Click on the 'SSL Policy' of the rule. This will take you to the alert causing SSL policy.\n12. Click on 'EDIT'\n13. Set 'Minimum TLS Version' to TLS 1.2 and set 'Profile' to Modern or Restricted.\n14. Alternatively, if you use the profile 'Custom', make sure that the following features are disabled:\nTLS_RSA_WITH_AES_128_GCM_SHA256\nTLS_RSA_WITH_AES_256_GCM_SHA384\nTLS_RSA_WITH_AES_128_CBC_SHA\nTLS_RSA_WITH_AES_256_CBC_SHA\nTLS_RSA_WITH_3DES_EDE_CBC_SHA\n15. Click on 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}