{
  "policyUpi": "PC-AWS-VPC-41",
  "policyId": "11743cd3-35e4-4639-91e1-bc87b52d4cf5",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS VPC subnets should not allow automatic public IP assignment",
  "description": "This policy identifies VPC subnets which allow automatic public IP assignment. VPC subnet is a part of the VPC having its own rules for traffic. Assigning the Public IP to the subnet automatically (on launch) can accidentally expose the instances within this subnet to internet and should be edited to 'No' post creation of the Subnet.",
  "rule.criteria": "11743cd3-35e4-4639-91e1-bc87b52d4cf5",
  "searchModel.query": "config from cloud.resource where cloud.type = 'AWS' and api.name = 'aws-ec2-describe-subnets' AND json.rule = 'mapPublicIpOnLaunch is true'",
  "recommendation": "1. Sign into the AWS console.\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated.\n3. Navigate to the 'VPC' service.\n4. In the navigation pane, click on 'Subnets'.\n5. Select the identified Subnet and choose the option 'Modify auto-assign IP settings' under the Subnet Actions.\n6. Disable the 'Auto-Assign IP' option and save it.",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws ec2 modify-subnet-attribute --subnet-id ${resourceId} --region ${region}  --no-map-public-ip-on-launch",
  "remediation.description": "This CLI command requires 'ec2:ModifySubnetAttribute' permission. Successful execution will disable automatic public IP assignment for the respective Subnet.",
  "remediation.impact": "Disable automatic public IP assignment for the respective Subnet",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "AWS Foundational Security Best Practices standard",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v3.0.1",
    "Cloud Security Assurance Program (CSAP) - IaaS",
    "Cloud Security Assurance Program (CSAP) - Low",
    "Cloud Security Assurance Program (CSAP) - Low SaaS",
    "Cloud Security Assurance Program (CSAP) - SaaS Simplified",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "HITRUST CSF v9.3 [Deprecated]",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO 27001:2013",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "Korea â€“ Information Security Management System (ISMS)",
    "MAS TRM 2021",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}