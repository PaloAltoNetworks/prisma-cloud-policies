{
  "policyUpi": "PC-PC-GCP-IAM-1136",
  "policyId": "1980fba9-f250-460b-a6d8-f62213f771f7",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "high",
  "name": "GCP Service account is publicly accessible",
  "description": "Publicly accessible GCP service accounts pose a significant security risk. Unrestricted access granted to 'allUsers' or 'allAuthenticatedUsers' allows unauthorized individuals to exploit the service account's permissions.\n\nGCP service accounts manage application and workload access within a project. Granting broad access, such as to 'allUsers' or 'allAuthenticatedUsers', bypasses least privilege principles. This misconfiguration enables malicious actors to potentially access sensitive data or resources, leading to data breaches or unauthorized modifications.\n\nThe impact of this misconfiguration includes data loss, unauthorized resource modification, and potential account compromise. Following the principle of least privilege by limiting access to only necessary entities is crucial to maintain security. Restricting access minimizes the potential damage from compromised credentials.\n\nTo remediate this risk, implement least privilege by granting only necessary permissions to specific service accounts. Avoid granting permissions to 'allUsers' or 'allAuthenticatedUsers'. Regularly review and revoke unnecessary permissions. Restrict access to the service account through appropriate network configurations and Identity and Access Management (IAM) roles.",
  "rule.criteria": "fe3570af-1bd8-4ad8-999d-bab609271304",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-iam-service-accounts-list' AND json.rule = ( iamPolicy.bindings[*].members contains \"allUsers\" or iamPolicy.bindings[*].members contains \"allAuthenticatedUsers\" ) and ( disabled does not exist or disabled is false )",
  "recommendation": "To revoke access from 'allusers'/'allAuthenticatedUsers', follow the below mentioned steps:\n1. Login to the GCP console\n2. Navigate to the 'IAM and Admin' service (Left Panel)\n3. Go to 'Service Accounts'\n4. Click on the alerting service account\n5. Under the 'PERMISSIONS' tab, select the 'VIEW BY PRINCIPALS' tab\n6. Select the entries with 'allUsers' or 'allAuthenticatedUsers' \n7. Click on the 'REMOVE ACCESS' to revoke access from 'allusers'/'allAuthenticatedUsers'\n8. Click on 'CONFIRM'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM) (Latest)",
    "CIS Controls v8.1",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "Microsoft Cloud Security Benchmark v1",
    "NCSC - Cyber Essentials",
    "NIST 800-53 Rev 5",
    "NYDFS 23 CRR-NY 500.0",
    "PCI DSS v4.0.1",
    "SOC 2",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}