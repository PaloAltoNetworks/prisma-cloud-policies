{
  "policyUpi": "PC-GCP-SQL-751",
  "policyId": "96c7404f-856a-42df-b4ea-61b3486806a5",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP PostgreSQL instance database flag log_hostname is not set to off",
  "description": "This policy identifies PostgreSQL database instances in which database flag log_hostname is not set to off. Logging hostnames can incur overhead on server performance as for each statement logged, DNS resolution will be required to convert IP address to hostname. It is recommended to set log_hostname as off.",
  "rule.criteria": "e4885f20-2e9d-4dab-aa72-61dff2ebda66",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-sql-instances-list' AND json.rule = \"state equals RUNNABLE and databaseVersion contains POSTGRES and (settings.databaseFlags[*].name does not contain log_hostname or settings.databaseFlags[?any(name contains log_hostname and value contains on)] exists)\"",
  "recommendation": "1. Log in to GCP console\n2. Navigate SQL Instances page\n3. Click on reported PostgreSQL instance\n4. Click EDIT\n5. If the flag has not been set on the instance, \nUnder 'Customize your instance', click on 'ADD FLAG' in 'Flags' section, choose the flag 'log_hostname' from the drop-down menu and set the value as 'off'\nOR\nIf the flag has been set to other than off, Under 'Customize your instance', In 'Flags' section choose the flag 'log_hostname' and set the value as 'off'\n6. Click on 'DONE' and then 'SAVE'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CRI Profile v1.2.1",
    "CSA CCM v.4.0.6",
    "FFIEC",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v4.0",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}