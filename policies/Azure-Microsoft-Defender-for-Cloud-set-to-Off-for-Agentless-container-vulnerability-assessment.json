{
  "policyUpi": "PC-AZR-SC-1315",
  "policyId": "b2bfe690-cfe1-408a-95dd-24330dbe9311",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "informational",
  "name": "Azure Microsoft Defender for Cloud set to Off for Agentless container vulnerability assessment",
  "description": "This policy identifies Azure Microsoft Defender for Cloud where the Agentless container vulnerability assessment is set to Off.\n\nAgentless container vulnerability assessment enables automatic scanning for vulnerabilities in container images stored in Azure Container Registry or running in Azure Kubernetes Service without additional agents. Disabling it exposes container images to unpatched security issues and misconfigurations, risking exploitation and data breaches. Enabling agentless container vulnerability assessment ensures continuous scanning for known vulnerabilities, enhancing security by proactively identifying risks and providing remediation suggestions to maintain compliance with industry standards.\n\nAs a security best practice, it is recommended to enable Agentless container vulnerability assessment in Azure Microsoft Defender for Cloud.",
  "rule.criteria": "3caab1bb-4547-45ca-914c-6a82a42ddd64",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-security-center-settings' AND json.rule = not (pricings[?any(properties.extensions[?any(name equal ignore case ContainerRegistriesVulnerabilityAssessments AND isEnabled is true)] exists AND properties.pricingTier equal ignore case Standard )] exists)",
  "recommendation": "1. Log in to the Azure portal\n2. Navigate to 'Microsoft Defender for Cloud'\n3. Under 'Management', select 'Environment Settings'\n4. Click on the subscription name\n5. Select the 'Defender plans'\n6. Click on 'Settings & monitoring' at the top\n7. In the table, find 'Agentless container vulnerability assessment' and select 'On' under Plan\n8. Click 'Continue' in the top left\n9. Click 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": ""
}