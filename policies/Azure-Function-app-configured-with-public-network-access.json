{
  "policyUpi": "PC-AZR-APP-1040",
  "policyId": "1f120b65-1350-4f7c-aadb-e9d8b6a52910",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure Function app configured with public network access",
  "description": "Azure Function apps configured with public network access allows unauthorized access, enabling attackers to exploit misconfigurations and compromise the application. Function apps should only be accessible through controlled networks.\n\nAzure Functions, by default, can be configured with public network access. This setting exposes the function app directly to the internet, increasing the attack surface. Untrusted IPs can directly interact with the function app, leading to potential data breaches, unauthorized code execution, or denial-of-service attacks.\n\nThe impact of this misconfiguration is significant, ranging from data exfiltration and service disruption to complete application compromise. Restricting access to authorized entities only, via private endpoints, minimizes the risk of exploitation and improves overall security posture.\n\nTo mitigate this risk, ensure Azure Function apps are configured with private endpoints, limiting access to trusted networks. Regularly review network configurations and disable public access unless explicitly required. Implement robust authentication and authorization mechanisms for further protection.",
  "rule.criteria": "6106ed75-4236-4183-961f-1a15bc403af7",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and kind does not contain workflowapp and kind does not equal app and properties.state equal ignore case running and ((properties.publicNetworkAccess exists and properties.publicNetworkAccess equal ignore case Enabled) or (properties.publicNetworkAccess does not exist)) and config.ipSecurityRestrictions[?any((action equals Allow and ipAddress equals Any) or (action equals Allow and ipAddress equals 0.0.0.0/0))] exists'",
  "recommendation": "To restrict App Service access, follow the below URL:\nhttps://learn.microsoft.com/en-us/azure/app-service/app-service-ip-restrictions",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM) (Latest)",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "NIST SP 800-171 Revision 3",
    "NYDFS 23 CRR-NY 500.0",
    "SOC 2",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2",
    "Telecommunications Security Act - TSA",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}