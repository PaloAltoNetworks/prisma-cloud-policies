{
  "policyUpi": "PC-AWS-EC2-31",
  "policyId": "7c714cb4-3d47-4c32-98d4-c13f92ce4ec5",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS EBS snapshots are accessible to public",
  "description": "This policy identifies EC2 EBS snapshots which are accessible to public. Amazon Elastic Block Store (Amazon EBS) provides persistent block storage volumes for use with Amazon EC2 instances in the AWS Cloud. If EBS snapshots are inadvertently shared to public, any unauthorized user with AWS console access can gain access to the snapshots and gain access to sensitive data.",
  "rule.criteria": "7c714cb4-3d47-4c32-98d4-c13f92ce4ec5",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' and api.name='aws-ec2-describe-snapshots' AND json.rule='createVolumePermissions[*].group contains all'",
  "recommendation": "1. Log in to the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to 'EC2' service.\n4. Under the 'Elastic Block Storage', click on the 'Snapshots'.\n5. For the specific Snapshots, change the value of field 'Property' to 'Private'.\n6. Under the section 'Encryption Details', set the value of 'Encryption Enabled' to 'Yes'.",
  "remediable": true,
  "remediation.cliScriptTemplate": "aws ec2 --region ${region} modify-snapshot-attribute --snapshot-id ${resourceId} --attribute createVolumePermission --operation-type remove --group-names all",
  "remediation.description": "This CLI command requires 'ec2:ModifySnapshotAttribute' permission. Successful execution will make this EBS snapshot's access to private. This will ensure that only Owner has full privileges.",
  "remediation.impact": "make this EBS snapshot private",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v3.0.1",
    "CSA CCM v4.0.12",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "GDPR",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v.9.6.0",
    "HITRUST CSF v9.3 [Deprecated]",
    "ISO 27001:2013",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Korea â€“ Information Security Management System (ISMS)",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0 [Deprecated]",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v6.3 [Deprecated]",
    "MITRE ATT&CK v8.2 [Deprecated]",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST 800-171 Rev1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "Otoritas Jasa Keuangan (OJK) 38 POJK.03 2016",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Risk Management in Technology (RMiT)",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2"
  ]
}