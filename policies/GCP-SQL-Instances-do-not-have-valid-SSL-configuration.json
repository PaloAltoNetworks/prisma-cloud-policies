{
  "policyUpi": "PC-GCP-SQL-89",
  "policyId": "08d12f5a-eaef-416b-9597-3e557ffa9161",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "low",
  "name": "GCP SQL Instances do not have valid SSL configuration",
  "description": "This policy identifies GCP SQL instances that either lack SSL configuration or have SSL certificates that have expired.\n\nIf an SQL instance is not configured to use SSL, it may accept unencrypted and insecure connections, leading to potential risks such as data interception and authentication vulnerabilities.\n\nIt is a best practice to enable SSL configuration to ensure data security and integrity when communicating with a GCP SQL instance.",
  "rule.criteria": "34249a95-438c-4780-a27c-e3d50092c177",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name='gcloud-sql-instances-list' and json.rule = \"(settings.ipConfiguration.sslMode equal ignore case TRUSTED_CLIENT_CERTIFICATE_REQUIRED and _DateTime.ageInDays(serverCaCert.expirationTime) > -1) or settings.ipConfiguration.sslMode equal ignore case ALLOW_UNENCRYPTED_AND_ENCRYPTED\"",
  "recommendation": "To configure SQL instance with SSL configuration,follow the steps mentioned below:\n\n1. Log in to google cloud console\n2. Navigate to 'Cloud SQL Instances'\n3. Click on the alerted instance and navigate to 'Security' under 'Connections' tab\n4. Select one of the following under 'Manage SSL mode':\n\t i. Allow only SSL connections\n\t ii. Require trusted client certificates\n\nTo verify the validity of the current certificate, follow the steps mentioned below:\n\n1. Log in to google cloud console\n2. Navigate to 'Cloud SQL Instances'\n3. Click on the alerted instance and navigate to 'Security' under 'Connections' tab\n4. Verify the expiration date of your server certificate under 'Manage server CA certificates' table\n\nTo create a new client certificate, follow the URL mentioned: https://cloud.google.com/sql/docs/mysql/configure-ssl-instance#client-certs",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "Australian Energy Sector Cyber Security Framework (AESCSF)",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CIS v1.0.0 (GCP)",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 1",
    "CIS v3.0.0 (GCP) Level 1",
    "CSA CCM v3.0.1",
    "CSA CCM v4.0.12",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "DORA",
    "FFIEC",
    "Framework for Adoption of Cloud Services by SEBI Regulated Entities (REs)",
    "GDPR",
    "HIPAA",
    "HITRUST CSF v.11.2.0",
    "HITRUST CSF v9.3 [Deprecated]",
    "ISO 27001:2013",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Insurance Regulatory And Development Authority Of India",
    "MITRE ATT&CK v15.1 Cloud IaaS for Enterprise",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "Microsoft Cloud Security Benchmark v1",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST CSF v2.0",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "NYDFS 23 CRR-NY 500.0",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PCI DSS v4.0.1",
    "PIPEDA",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Risk Management in Technology (RMiT)",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 2",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}