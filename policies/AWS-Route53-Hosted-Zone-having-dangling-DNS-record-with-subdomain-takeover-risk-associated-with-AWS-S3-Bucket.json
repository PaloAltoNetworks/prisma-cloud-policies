{
  "policyUpi": "PC-AWS-R53-991",
  "policyId": "74a38c42-ed2f-4172-b047-12be56495aca",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "high",
  "name": "AWS Route53 Hosted Zone having dangling DNS record with subdomain takeover risk associated with AWS S3 Bucket",
  "description": "Dangling DNS records in AWS Route53 Hosted Zones, pointing to non-existent S3 buckets, create a subdomain takeover risk. An attacker could register a new S3 bucket with the same name, redirecting traffic and potentially compromising user data.\n\nThe misconfiguration involves a CNAME record in Route53 that references a deleted or non-existent S3 bucket. This allows attackers to create an S3 bucket with the same name, effectively taking control of the subdomain. This can lead to phishing attacks, malware distribution, and data breaches.\n\nImpact includes reputational damage, financial losses, and legal liabilities. Maintaining accurate DNS records prevents attackers from exploiting this vulnerability. Deleting dangling DNS entries ensures only valid resources are accessible.\n\nTo mitigate this, regularly review Route53 Hosted Zones for CNAME records pointing to S3 buckets. Verify the existence of each referenced bucket. Delete any CNAME records associated with non-existent buckets. Implement automated checks to proactively identify and remove dangling DNS entries.",
  "rule.criteria": "7a6582fb-4264-4805-9341-331be346e868",
  "searchModel.query": "config from cloud.resource where api.name = 'aws-route53-list-hosted-zones' AND json.rule = hostedZone.config.privateZone is false and resourceRecordSet[?any( type equals CNAME and resourceRecords[*].value contains s3-website )] exists as X; config from cloud.resource where api.name = 'aws-s3api-get-bucket-acl' as Y; filter 'not ($.X.resourceRecordSet[*].name intersects $.Y.bucketName)'; show X;",
  "recommendation": "Identify DNS record entry pointing to a non-existing S3 bucket resource.\n\nTo remove DNS record entry, follow steps given in following URL:\nhttps://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-deleting.html",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM) (Latest)",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 1",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 2",
    "Australian Cyber Security Centre (ACSC) Essential Eight - Level 3",
    "CRI Profile v2.0",
    "DORA",
    "HITRUST CSF v.11.2.0",
    "ISO/IEC 27001:2022",
    "ITSG-33",
    "Korea â€“ Information Security Management System (ISMS)",
    "Microsoft Cloud Security Benchmark v1",
    "NCSC Cloud Security Principles",
    "NIST CSF v2.0",
    "PCI DSS v4.0.1",
    "SEBI - Consolidated Cybersecurity and Cyber Resilience Framework (CSCRF)",
    "TX-RAMP Level 2",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}