{
  "policyUpi": "PC-AZR-SQL-656",
  "policyId": "aa62cb1d-2bcb-478b-af5c-62462f8a6cba",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure SQL Server ADS Vulnerability Assessment Periodic recurring scans is disabled",
  "description": "This policy identifies Azure SQL Server which has ADS Vulnerability Assessment Periodic recurring scans disabled. Advanced Data Security - Vulnerability Assessment 'Periodic recurring scans' schedules periodic vulnerability scanning for the SQL server and Databases. It is recommended to enable ADS - VA Periodic recurring scans which provides risk visibility based on updated known vulnerability signatures and best practices.",
  "rule.criteria": "5c28d8a1-5f19-4914-a9bc-60e201d3939c",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-sql-server-list' AND json.rule = vulnerabilityAssessments[*].properties.storageContainerPath exists and vulnerabilityAssessments[*].properties.recurringScans.isEnabled is false",
  "recommendation": "1. Log in to the Azure portal\n2. Select 'SQL servers', and select the SQL server you need to modify\n3. Click on 'Security Center' under Security\n4. Click on '(Configure)' next to 'Azure Defender for SQL: Enabled at the server-level'\n5. Set 'Periodic recurring scans' to 'ON' under 'VULNERABILITY ASSESSMENT SETTINGS'\n6. 'Save' your changes",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "NIST SP 800-171 Revision 2",
    "PCI DSS v3.2.1"
  ]
}