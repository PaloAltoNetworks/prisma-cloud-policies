{
  "policyUpi": "PC-GCP-SQL-537",
  "policyId": "fc6634c3-7ab9-4a84-a447-09499b1e418c",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "medium",
  "name": "GCP SQL Server instance database flag 'cross db ownership chaining' is enabled",
  "description": "This policy identifies GCP SQL Server instance database flag 'cross db ownership chaining' is enabled. Enabling cross db ownership is not recommended unless all of the databases hosted by the instance of SQL Server must participate in cross-database ownership chaining and you are aware of the security implications of this setting.",
  "rule.criteria": "1f618d6e-42c5-4861-b7bb-6636a597aeac",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-sql-instances-list' AND json.rule = \"databaseVersion contains SQLSERVER and settings.databaseFlags[?(@.name=='cross db ownership chaining')].value equals on\"",
  "recommendation": "1. Login to GCP Console\n2. Navigate to SQL\n3. Click on the SQL Server instance for which you want to disable the database flag from the list\n4. Click 'Edit'\n5. Go to  'Flags and Parameters'  under 'Configuration options' section\n6. Search for the flag 'cross db ownership chaining' and set the value 'off'\n7. Click on 'Save'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security"
  ]
}