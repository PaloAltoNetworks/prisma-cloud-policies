{
  "policyUpi": "PC-AWS-RDS-330",
  "policyId": "7c41236b-3812-4065-bc2b-57d831fbb876",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS RDS instance not in private subnet",
  "description": "This policy identifies AWS RDS instance which are not in a private subnet. RDS should not be deployed in a public subnet, production databases should be located behind a DMZ in a private subnet with limited access in most scenarios.",
  "rule.criteria": "1f2887c9-cc4a-48f3-b8aa-a69bdfb9e19d",
  "searchModel.query": "config from cloud.resource where api.name = 'aws-rds-describe-db-instances' as X; config from cloud.resource where api.name = 'aws-ec2-describe-route-tables' AND json.rule = associations[*].subnetId exists and routes[?any( state equals active and gatewayId starts with igw- and (destinationCidrBlock equals \"0.0.0.0/0\" or destinationIpv6CidrBlock equals \"::/0\"))] exists as Y; filter '$.X.dbsubnetGroup.subnets[*].subnetIdentifier intersects $.Y.associations[*].subnetId'; show X;",
  "recommendation": "To resolve this alert, you should redeploy RDS into a private RDS Subnet group.\n\nNote: You can not move an existing RDS instance from one subnet to another.\n\nCreate a RDS Subnet group:\n\nA DB subnet group is a collection of subnets (typically private) that you create for a VPC and that you then designate for your DB instances.\n\n1. Open the Amazon RDS console\n2. In the navigation pane, choose 'Subnet groups'\n3. Choose 'Create DB Subnet Group'\n4. Type the 'Name' of your DB subnet group\n5. Add a 'Description' for your DB subnet group\n6. Choose your 'VPC'\n7. Choose 'Availability Zones'\n8. In the Add subnets section, add your Private subnets related to this VPC\n9. Choose Create\n\nWhen creating your RDS DB, under Configure advanced settings, choose the Subnet group created above.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CSA CCM v.4.0.1",
    "CyberSecurity Law of the People's Republic of China",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 1)",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "HITRUST CSF v.9.6.0",
    "HITRUST v.9.4.2",
    "ISO 27002:2022",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "MAS TRM 2021",
    "MITRE ATT&CK v10.0",
    "MITRE ATT&CK v12",
    "MITRE ATT&CK v13.0 Cloud IaaS for Enterprise",
    "MITRE ATT&CK v14.0 Cloud IaaS for Enterprise",
    "MLPS 2.0",
    "MLPS 2.0 (Level 2)",
    "MLPS 2.0 (Level 3)",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PCI DSS v4.0",
    "PIPEDA",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1"
  ]
}