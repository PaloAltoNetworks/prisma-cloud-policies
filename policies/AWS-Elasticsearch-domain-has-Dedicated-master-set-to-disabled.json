{
  "policyUpi": "PC-AWS-ES-177",
  "policyId": "5727a110-89e3-4f9f-befa-6ed9d2f474a1",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "low",
  "name": "AWS Elasticsearch domain has Dedicated master set to disabled",
  "description": "This policy identifies Elasticsearch domains for which Dedicated master is disabled in your AWS account. If dedicated master nodes are provided those handle the management tasks and cluster nodes can easily manage index and search requests from different types of workload and make them more resilient in production. Dedicated master nodes improve environmental stability by freeing all the management tasks from the cluster data nodes.",
  "rule.criteria": "ea657be6-6810-4964-9a15-81a8f0177784",
  "searchModel.query": "config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-es-describe-elasticsearch-domain' AND json.rule = 'processing is false and (elasticsearchClusterConfig.dedicatedMasterEnabled is false or elasticsearchClusterConfig.dedicatedMasterEnabled does not exist)'",
  "recommendation": "1. Sign into the AWS console\n2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated\n3. Navigate to Elasticsearch Service Dashboard\n4. Choose reported Elasticsearch domain\n5. Click on 'Edit Domain'\n6. On the 'Edit domain' page,\n\ta. Check 'Enable dedicated master' checkbox to enable dedicated master nodes for the current cluster.\n\tb. Select the 'Instance type' based on your ES cluster requirements from the dropdown list.\n\tNote: As dedicated master nodes do not hold any data nor process any search and query requests, the instance node for this role typically does not require a large amount of CPU/RAM memory.\n\tc. Select the 'Number of master nodes' from dropdown list to allocate dedicated master nodes.\n7. Click on 'Submit'",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST v.9.4.2",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1"
  ]
}