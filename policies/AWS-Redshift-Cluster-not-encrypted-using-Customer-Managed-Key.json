{
  "policyUpi": "PC-AWS-RED-318",
  "policyId": "dae05966-c2ac-480f-9ef5-50e91fd57782",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS Redshift Cluster not encrypted using Customer Managed Key",
  "description": "This policy identifies Redshift Clusters which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Redshift databases data. Customer-managed CMKs give you more flexibility, including the ability to create, rotate, disable, define access control for, and audit the encryption keys used to help protect your data.",
  "rule.criteria": "3597d4f8-7e3b-4c73-9418-00e3314e5f39",
  "searchModel.query": "config from cloud.resource where api.name = 'aws-redshift-describe-clusters' as X; config from cloud.resource where api.name = 'aws-kms-get-key-rotation-status' as Y; filter '$.X.encrypted is true and $.X.kmsKeyId equals $.Y.key.keyArn and $.Y.keyMetadata.keyManager contains AWS'; show X;",
  "recommendation": "To enable encryption with Customer Managed Key on your Redshift cluster follow the steps mentioned in below URL:\nhttps://docs.aws.amazon.com/redshift/latest/mgmt/changing-cluster-encryption.html",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA"
  ]
}