{
  "policyUpi": "PC-AZR-K8S-394",
  "policyId": "46e1ba70-fb35-4a44-a551-17ea04c4d8e7",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "low",
  "name": "Azure AKS cluster pool profile count contains less than 3 nodes",
  "description": "This policy identifies AKS clusters that are configured with node pool profile less than 3 nodes. It is recommended to have at least 3 or more than 3 nodes in a node pool for a more resilient cluster. (Clusters smaller than 3 may experience downtime during upgrades.)",
  "rule.criteria": "cbfe2dc0-85e0-4444-8433-594d39b45d7f",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-kubernetes-cluster' AND json.rule = 'properties.powerState.code equal ignore case Running and properties.agentPoolProfiles[?any(type equal ignore case AvailabilitySet and count less than 3)] exists'",
  "recommendation": "To scale AKS cluster node pool nodes count, follow below URL:\nhttps://learn.microsoft.com/en-gb/azure/aks/scale-cluster?tabs=azure-cli",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "ACSC Information Security Manual (ISM)",
    "ACSC Information Security Manual (ISM) (Latest)",
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v7.1",
    "CIS Controls v8",
    "CIS Controls v8.1",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "Cybersecurity Maturity Model Certification (CMMC) v.2.0 (Level 2)",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "Insurance Regulatory And Development Authority Of India",
    "MLPS 2.0 (Level 2)",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "New Zealand Information Security Manual (NZISM v3.4)",
    "PCI DSS v3.2.1",
    "RBI Baseline Cyber Security and Resilience Requirements",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2"
  ]
}