{
  "policyUpi": "PC-GCP-GCE-549",
  "policyId": "17ad5166-9858-47e8-85ea-e42575a2112e",
  "policyType": "config",
  "cloudType": "gcp",
  "severity": "informational",
  "name": "GCP VM instance with Shielded VM features disabled",
  "description": "This policy identifies VM instances which have Shielded VM features disabled. Shielded VMs are virtual machines (VMs) on Google Cloud Platform hardened by a set of security controls that help defend against rootkits and bootkits. Shielded VM's verifiable integrity is achieved through the use of Secure Boot, virtual trusted platform module (vTPM)-enabled Measured Boot, and integrity monitoring. Shielded VM instances run firmware which is signed and verified using Google's Certificate Authority, ensuring that the instance's firmware is unmodified and establishing the root of trust for Secure Boot.\n\nNOTE: You can only enable Shielded VM options on instances that have Shielded VM support. This policy reports VM instances that have Shielded VM support and are disabled with the Shielded VM features.",
  "rule.criteria": "6a132d82-267f-40ed-a6c9-1b426df1e928",
  "searchModel.query": "config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-compute-instances-list' AND json.rule = '(status equals RUNNING and name does not start with \"gke-\") and shieldedInstanceConfig exists and (shieldedInstanceConfig.enableVtpm is false or shieldedInstanceConfig.enableIntegrityMonitoring is false)'",
  "recommendation": "1. Log in to GCP console\n2. Navigate VM instances page\n3. STOP the reported VM instance before editing the instance\nNOTE: Before stoping the instance, Check the VM instance operational requirement.\n4. After the instance stops, click 'EDIT'\n5. In the Shielded VM section, select 'Turn on vTPM' and 'Turn on Integrity Monitoring'.\nOptionally, if you do not use any custom or unsigned drivers on the instance, also select 'Turn on Secure Boot'.\n6. Click on 'Save' and then START the instance.",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CIS Controls v8.1",
    "CIS v1.1.0 (GCP)",
    "CIS v1.2.0 (GCP)",
    "CIS v1.3.0 (GCP)",
    "CIS v2.0.0 (GCP) Level 2",
    "CIS v3.0.0 (GCP) Level 2",
    "CSA CCM v.4.0.1",
    "CSA CCM v4.0.12",
    "Cloud Security Assurance Program (CSAP) - IaaS",
    "Cloud Security Assurance Program (CSAP) - Low",
    "Cloud Security Assurance Program (CSAP) - Low SaaS",
    "Cloud Security Assurance Program (CSAP) - SaaS Simplified",
    "Cloud Security Assurance Program (CSAP) - SaaS Standard",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "GDPR",
    "HITRUST v.9.4.2 [Deprecated]",
    "ISO/IEC 27001:2022",
    "ISO/IEC 27002:2013",
    "ISO/IEC 27017:2015",
    "ISO/IEC 27018:2019",
    "ITSG-33",
    "Microsoft Cloud Security Benchmark v1",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-171 Revision 3",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "SOC 2",
    "Sarbanes Oxley Act (SOX)",
    "Secure Controls Framework (SCF) - 2022.2.1",
    "Secure Controls Framework (SCF) - 2024.2",
    "TX-RAMP Level 1",
    "TX-RAMP Level 2",
    "Trusted Information Security Assessment Exchange (TISAX)"
  ]
}